/* ta.js (c) Nino Kroesen. MIT License. */ async function median(n,e=n.length){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t);r.sort((n,e)=>n-e),a.push(r[Math.round(r.length/2)-1])}return a}async function kmeans(n,e){for(var t,a=[],r=[],l=[],s=!1,_=Math.round(n.length/(e+1)),i=0;i<e;i++)r[i]=n[_*(i+1)];do{for(var i=0;i<e;i++)a[i]=[];for(var $=0;$<n.length;$++){for(var h=-1,u=0;u<e;u++){var o=Math.abs(r[u]-n[$]);-1===h?(h=o,t=u):o<=h&&(h=o,t=u)}a[t].push(n[$])}l=r;for(var $=0;$<e;$++){var p=0;for(u=0;u<a[$].length;u++)p+=a[$][u];var c=p/a[t].length;r[$]=c}for(var $=0;$<e;$++)r[$]!==l[$]&&(s=!0)}while(s);return a}async function normalize(n,e=0){for(var t=0,a=await Math.max.apply(null,n.slice())*(1+e),r=await Math.min.apply(null,n.slice())*(1-e),l=[];t<n.length;t++)l.push(1-(a-n[t])/(a-r));return l}async function denormalize(n,e,t=0){for(var a=0,r=await Math.max.apply(null,n.slice())*(1+t),l=await Math.min.apply(null,n.slice())*(1-t),s=[];a<e.length;a++)s.push(l+e[a]*(r-l));return s}async function normalize_pair(n,e){for(var t=1,a=(n[0]+e[0])/2,r=[[a,a]];t<n.length;t++)r.push([r[r.length-1][0]*((n[t]-n[t-1])/n[t-1]+1),r[r.length-1][1]*((e[t]-e[t-1])/e[t-1]+1)]);return r}async function normalize_from(n,e){for(var t=1,a=[e];t<n.length;t++)a.push(a[a.length-1]*((n[t]-n[t-1])/n[t-1]+1));return a}async function standardize(n){for(var e=await module.exports.sma(n,n.length),t=await module.exports.std(n),a=[],r=0;r<n.length;r++)a.push((n[r]-e[0])/t);return a}async function mad(n,e=n.length){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=await module.exports.median(r),s=r.map(n=>Math.abs(n-l[l.length-1]));s=await module.exports.median(s),a.push(s[s.length-1])}return a}async function aad(n,e=n.length){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=0,s=await module.exports.sma(r,e);for(q in r)l+=Math.abs(r[q]-s[s.length-1]);a.push(l/e)}return a}async function ssd(n,e=n.length){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=await module.exports.sma(r,e),s=0;for(let _ in r)s+=(r[_]-l[l.length-1])**2;a.push(Math.sqrt(s))}return a}async function er(n){var e=[],t=[],a=1,r=1;for(let l in n)n[l]>=0?e.push(1+n[l]):t.push(1+n[l]);var s=e.length/n.length,_=t.length/n.length;for(let i in t)r*=t[i];for(let $ in e)a*=e[$];return((a**(1/e.length)-1)*100*s+(r**(1/t.length)-1)*100*_)/100}async function ar(n,e=n.length){for(var t=e,a=[];t<n.length;t++){var r=await module.exports.er(n.slice(t-e,t));a.push(n[t]-r)}return a}async function kelly(n){var e=await module.exports.er(n)+1,t=await module.exports.winratio(n);return isNaN(e)&&(e=1),t-(1-t)/e}async function martingale(n,e,t,a=2){var r=e;for(let l in n)n[l]<0?r*=a:n[l]>0&&(r=e);return r>t?t:r}async function antimartingale(n,e,t,a=2){var r=e;for(let l in n)n[l]>0?r*=a:n[l]<0&&(r=e);return r>t?t:r}async function winratio(n){var e=0,t=0;for(let a in n)n[a]>=0?e++:t++;return e/(t+e)}async function avgwin(n){for(var e=0,t=[];e<n.length;e++)n[e]>=0&&t.push(n[e]);return(await module.exports.sma(t,t.length))[0]}async function avgloss(n){for(var e=[],t=0;t<n.length;t++)n[t]<0&&e.push(n[t]);return(await module.exports.sma(e,e.length))[0]}async function zscore(n,e=n.length){for(var t=e-1,a=[],r=n.slice(0,e-1);t<n.length;t++){r.push(n[t]);var l=await module.exports.sma(r,e),s=await module.exports.std(r,e);a.push((n[t]-l[0])/s),r.splice(0,1)}return a}async function rsi(n,e=14){for(var t=e-1,a=0,r=0,l=[],s=n.slice(0,e-1);t<n.length;t++,a=0,r=0){s.push(n[t]);for(var _=1;_<s.length;_++)s[_]-s[_-1]<0?r+=Math.abs(s[_]-s[_-1]):a+=s[_]-s[_-1];var i=100-100/(1+a/e/(r/e));l.push(i),s.splice(0,1)}return l}async function wrsi(n,e=14){for(var t=1,a=[],r=[],l=[];t<n.length;t++)n[t]-n[t-1]<0?(l.push(Math.abs(n[t]-n[t-1])),r.push(0)):(l.push(0),r.push(n[t]-n[t-1]));for(let s in l=await module.exports.wsma(l,e),r=await module.exports.wsma(r,e),l)a.push(100-100/(1+r[s]/l[s]));return a}async function tsi(n,e=25,t=13,a=13){for(var r=1,l=[],s=[],_=[],i=[];r<n.length;r++)l.push(n[r]-n[r-1]),s.push(Math.abs(n[r]-n[r-1]));for(var $=await module.exports.ema(l,e),h=await module.exports.ema(s,e),u=await module.exports.ema($,t),o=await module.exports.ema(h,t),r=0;r<u.length;r++)_.push(u[r]/o[r]);var p=await module.exports.ema(_,a);_.splice(0,_.length-p.length);for(var r=0;r<p.length;r++)i.push([p[r],_[r]]);return i}async function bop(n,e=14){var t=n.map(n=>(n[3]-n[0])/(n[1]-n[2])),t=await module.exports.sma(t,e);return t}async function fi(n,e=13){for(var t=1,a=[],r=[];t<n.length;t++)if(a.push((n[t][0]-n[t-1][0])*n[t][1]),a.length>=e){var l=await module.exports.ema(a,e);r.push(l[l.length-1]),a.splice(0,1)}return r}async function asi(n){for(var e=1,t=[];e<n.length;e++){var a,r=n[e][1],l=n[e-1][1],s=n[e][0],_=n[e-1][0],i=n[e][2],$=n[e-1][2],h=_-r>$-r?_-r:$-r,u=n[e][0],o=n[e-1][0],p=Math.max(n[e][0],n[e-1][0])-Math.min(n[e][2],n[e-1][2]);s-l>i-l&&s-l>s-i&&(a=s-l-(i-l)/2+(l-o)/4),i-l>s-l&&i-l>s-i&&(a=i-l-(s-l)/2+(l-o)/4),s-i>s-l&&s-i>i-l&&(a=s-i+(l-o)/4),t.push(50*((l-r+(l-o)/2+(r-u)/2)/a)*h/p)}return t}async function ao(n,e=5,t=35){n=n.map(n=>(n[0]+n[1])/2);for(var a=t,r=[];a<=n.length;a++){var l=n.slice(a-t,a),s=await module.exports.sma(l,e),_=await module.exports.sma(l,t);r.push(s[s.length-1]-_[_.length-1])}return r}async function ac(n,e=5,t=35){var a=await ao(n,e,t),r=await sma(a,e),l=[];for(let s in a.length>r.length?a.splice(0,a.length-r.length):r.splice(0,r.length-a.length),a)l.push(a[s]-r[s]);return l}const fib=async(n,e)=>[n,(e-n)*.236+n,(e-n)*.382+n,(e-n)*.5+n,(e-n)*.618+n,(e-n)*.786+n,e,(e-n)*1.618+n,(e-n)*2.618+n,(e-n)*3.618+n,(e-n)*4.236+n];async function pr(n,e=14){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=await Math.max.apply(null,r),s=await Math.min.apply(null,r);a.push(-((l-n[t-1])/(l-s)*100))}return a}async function lsma(n,e=25){for(var t=e,a=[];t<=n.length;t++){for(var r,l,s=n.slice(t-e,t),_=0,i=0,$=0,h=0,u=0,o=1;o<=e;o++)_+=o,i+=s[o-1],$+=s[o-1]*o,h+=o*o,u+=s[o-1]*s[o-1];r=($-_*i/e)/(h-_*_/e),l=i/e-r*_/e,a.push(r*e+l)}return a}async function don(n,e=20){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=[],s=[];for(let _ in r)l.push(r[_][0]),s.push(r[_][1]);var i=Math.max.apply(null,l.slice()),$=Math.min.apply(null,s.slice());a.push([i,(i+$)/2,$])}return a}async function ichimoku(n,e=9,t=26,a=52,r=26){for(var l=0,s=[],_=[],i=[];l<n.length;l++)if(s.push(n[l]),s.length>=a){var $=[],h=[];for(let u in s)$.push(s[u][0]),h.push(s[u][2]);var o=(Math.max.apply(null,$.slice($.length-e,$.length))+Math.min.apply(null,h.slice(h.length-e,h.length)))/2,p=(Math.max.apply(null,$.slice($.length-t,$.length))+Math.min.apply(null,h.slice(h.length-t,h.length)))/2,c=n[l][1]+p,g=(Math.max.apply(null,$.slice($.length-a,$.length))+Math.min.apply(null,h.slice(h.length-t,h.length)))/2;chik=n[l][1],i.push([o,p,c,g,chik]),s.splice(0,1)}for(var l=r;l<i.length-r;l++)_.push([i[l][0],i[l][1],i[l+r][2],i[l+r][3],i[l-r][4]]);return _}async function stoch(n,e=14,t=3,a=3){e<t&&([e,t]=[t,e]),a>t&&([a,t]=[t,a]);for(var r=0,l=[],s=[],_=[],i=[];r<n.length;r++){if(s.push(n[r][0]),_.push(n[r][2]),s.length>=e){var $=await Math.max.apply(null,s),h=await Math.min.apply(null,_),u=100*(n[r][1]-h)/($-h);i.push(u)}if(a>0&&i.length>a){var o=await module.exports.sma(i,a);i.push(o[o.length-1])}if(i.length-a>=t){var p=await module.exports.sma(i,t);l.push([u,p[p.length-1]]),s.splice(0,1),_.splice(0,1),i.splice(0,1)}}return l}async function atr(n,e=14){for(var t=1,a=[n[0][0]-n[0][2]];t<n.length;t++){var r=await Math.max(n[t][0]-n[t-1][1],n[t][2]-n[t-1][1],n[t][0]-n[t][2]);a.push((a[a.length-1]*(e-1)+r)/e)}return a}async function sma(n,e=14){for(var t=e,a=[];t<=n.length;t++){let r=await module.exports.sum(n.slice(t-e,t));a.push(r/e)}return a}async function smma(n,e=14){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=0;for(q in r)l+=r[q];a.length<=0?a.push(l/e):a.push((l-a[a.length-1])/e)}return a.splice(0,1),a}async function wma(n,e=14){for(var t=1,a=0,r=[];t<=e;t++)a+=t;for(var t=e;t<=n.length;t++){var l=n.slice(t-e,t),s=0;for(q in l)s+=l[q]*(Number(q)+1)/a;r.push(s)}return r}async function wsma(n,e=14){for(var t=e,a=[],r=1/e;t<=n.length;t++){if(a.length>0){a.push((n[t-1]-a[a.length-1])*r+a[a.length-1]);continue}var l=n.slice(t-e,t),s=0;for(q in l)s+=l[q];a.push(s/e)}return a}async function pwma(n,e=14){for(var t=e/2,a=e,r=0,l=[],s=[];t>=1;t--,a--)t%1!=0?r+=(t=Math.round(t))*a:(s.push(t*a),r+=t*a*2),s.unshift(t*a);for(var t=e;t<=n.length;t++){for(var _=0,i=n.slice(t-e,t),$=e-1;$>=0;$--)_+=i[$]*s[$]/r;l.push(_)}return l}async function hwma(n,e=14){for(var t=1,a=e,r=0,l=[],s=[];t<=e/2;t++,a--)t%1!=0?r+=(t=Math.round(t))*a:(s.push(t*a),r+=t*a*2),s.unshift(t*a);for(var t=e;t<=n.length;t++){for(var _=0,i=n.slice(t-e,t),$=e-1;$>=0;$--)_+=i[$]*s[$]/r;l.push(_)}return l}async function vwma(n,e=20){n=n.map(n=>[n[0]*n[1],n[1]]);for(var t=e,a=[];t<=n.length;t++){for(var r=n.slice(t-e,t),l=0,s=0,_=0;_<r.length;_++)l+=r[_][1],s+=r[_][0];a.push(s/l)}return a}async function ema(n,e=12){for(var t=e,a=[],r=2/(e+1);t<=n.length;t++){if(a.length>0){a.push((n[t-1]-a[a.length-1])*r+a[a.length-1]);continue}var l=n.slice(t-e,t),s=0;for(q in l)s+=l[q];a.push(s/e)}return a}async function hull(n,e=14){var t=[],a=[],r=await module.exports.wma(n,e),l=Math.round(Math.sqrt(e)),s=await wma(n,Math.round(e/2));for(let _ in s.splice(0,s.length-r.length),r)if(t.push(2*s[_]-r[_]),t.length>=l){var i=await wma(t,l);a.push(i[0]),t.splice(0,1)}return a}async function kama(n,e=10,t=2,a=30){for(var r=e+1,l=await module.exports.sma(n,e),l=[l[l.length-1]];r<n.length;r++){for(var s=0,_=Math.abs(n[r]-n[r-e]),i=1;i<e;i++)s+=Math.abs(n[r-i]-n[r-i-1]);var $=(_/s*(2/(t+1)-2/(a+1)+2/(a+1)))**2;l.push(l[l.length-1]+$*(n[r]-l[l.length-1]))}return l}async function macd(n,e=12,t=26){e>t&&([e,t]=[t,e]);var a=await module.exports.ema(n,e),r=await module.exports.ema(n,t),l=[];a.splice(0,t-e);for(var s=0;s<r.length;s++)l.push(a[s]-r[s]);return l}async function macd_signal(n,e=12,t=26,a=9){return await module.exports.ema(await module.exports.macd(n,e,t),a)}async function macd_bars(n,e=12,t=26,a=9){var r=await module.exports.macd(n,e,t),l=await module.exports.ema(r,a),s=[];for(let _ in r.splice(0,r.length-l.length),r)s.push(r[_]-l[_]);return s}async function bands(n,e=14,t=1){for(var a=0,r=[],l=[],s=[],_=await module.exports.sma(n,e);a<n.length;a++)if(r.push(n[a]),r.length>=e){var i=await module.exports.std(r,e);l.push(i),r.splice(0,1)}for(var a=0;a<_.length;a++)s.push([_[a]+l[a]*t,_[a],_[a]-l[a]*t]);return s}async function bandwidth(n,e=14,t=1){for(var a=0,r=[],l=await module.exports.bands(n,e,t);a<l.length;a++)r.push((l[a][0]-l[a][2])/l[a][1]);return r}async function keltner(n,e=14,t=1){var a,r=[],l=await module.exports.atr(n,e),s=[];for(let _ in n)r.push((n[_][0]+n[_][1]+n[_][2])/3);a=await module.exports.sma(r,e),l.splice(0,e-1);for(var i=0;i<a.length;i++)s.push([a[i]+l[i]*t,a[i],a[i]-l[i]*t]);return s}async function variance(n,e=n.length){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=await module.exports.sma(r,e),s=0;for(x in r)s+=(r[x]-l[l.length-1])**2;a.push(s/e)}return a}async function std(n,e=n.length){e<n.length&&n.splice(0,n.length-e);var t=n.reduce((n,e)=>n+e)/e;return Math.sqrt(n.reduce((n,e)=>n+Math.pow(e-t,2),0)/e)}async function normsinv(n){if(n<0||n>1)return 0;if(n<.02425){var e=Math.sqrt(-2*Math.log(n));return(((((-.00778489400243029*e+-.322396458041136)*e+-2.40075827716184)*e+-2.54973253934373)*e+4.37466414146497)*e+2.93816398269878)/((((.00778469570904146*e+.32246712907004)*e+2.445134137143)*e+3.75440866190742)*e+1)}if(n<=.97575){var e=n-.5,t=e*e;return(((((-39.6968302866538*t+220.946098424521)*t+-275.928510446969)*t+138.357751867269)*t+-30.6647980661472)*t+2.50662827745924)*e/(((((-54.4760987982241*t+161.585836858041)*t+-155.698979859887)*t+66.8013118877197)*t+-13.2806815528857)*t+1)}var e=Math.sqrt(-2*Math.log(1-n));return-(((((-.00778489400243029*e+-.322396458041136)*e+-2.40075827716184)*e+-2.54973253934373)*e+4.37466414146497)*e+2.93816398269878)/((((.00778469570904146*e+.32246712907004)*e+2.445134137143)*e+3.75440866190742)*e+1)}async function sim(n,e=50,t=1e3,a){for(var r=0,l=[];r<t;r++){for(var s=n.slice(),_=0;_<e;_++){for(var i=[],$=1;$<s.length;$++){var h=await module.exports.dif(s[$],s[$-1]);i.push(h)}var u=await module.exports.sma(i,i.length),o=await module.exports.std(i),p=await module.exports.normsinv(Math.random());s.push(s[s.length-1]*Math.exp(u[0]-o*o/2+o*p))}l.push(s)}return a?await module.exports.percentile(l,a):l}async function percentile(n,e){for(var t=0,a=[];t<n[0].length;t++)n.sort((n,e)=>n[t]-e[t]),a.push(n[Math.round((n.length-1)*e)][t]);return a}async function cor(n,e){for(var t=await module.exports.sma(n,n.length),a=await module.exports.sma(e,e.length),r=0,l=0,s=0,_=0;_<n.length;_++){var i=n[_]-t,$=e[_]-a;r+=i*$,l+=Math.pow(i,2),s+=Math.pow($,2)}var h=n.length-1;return l/=h,s/=h,r/(h*(l=Math.sqrt(l))*(s=Math.sqrt(s)))}const dif=async(n,e)=>(n-e)/e,log=async n=>n.map(n=>Math.log(n)),exp=async n=>n.map(n=>Math.exp(n));async function drawdown(n){for(var e=1,t=n[0],a=n[0],r=0;e<n.length;e++){if(n[e]>t){if(0!=a){var l=await module.exports.dif(a,t);l<r&&(r=l),a=n[e]}t=n[e]}n[e]<a&&(a=n[e])}var l=await module.exports.dif(a,t);return l<r&&(r=l),r}async function aroon_up(n,e=10){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=r.slice();l.sort((n,e)=>n-e),a.push(100*(e-1-r.reverse().findIndex(n=>n===l[e-1]))/(e-1))}return a}async function aroon_down(n,e=10){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=r.slice();l.sort((n,e)=>n-e),a.push(100*(e-1-r.reverse().findIndex(n=>n===l[0]))/(e-1))}return a}async function aroon_osc(n,e=25){for(var t=0,a=[],r=await module.exports.aroon.up(n,e),l=await module.exports.aroon.down(n,e);t<r.length;t++)a.push(r[t]-l[t]);return a}async function mfi(n,e=14){for(var t=e,a=[],r=n.map(n=>n[1]),l=n.map(n=>n[0]),s=0,_=0;t<=n.length;t++,s=0,_=0){for(q=t-e;q<t;q++)s+=l[q],_+=r[q];a.push(100-100/(1+s/_))}return a}async function roc(n,e=14){for(var t=e,a=[];t<=n.length;t++)a.push((n[t-1]-n[t-e])/n[t-e]);return a}async function cop(n,e=11,t=14,a=10){for(var r=Math.max(e,t),l=[],s=r+a;s<n.length;s++){var _=n.slice(s-(r+a),s),i=_.slice(),$=[];_=await module.exports.roc(_,e),i=await module.exports.roc(i,t),_.splice(0,_.length-i.length),i.splice(0,i.length-_.length);for(var h=0;h<_.length;h++)$.push(_[h]+i[h]);$=await module.exports.wma($,a),l.push($[$.length-1])}return l}async function kst(n,e=10,t=15,a=20,r=30,l=10,s=10,_=10,i=15,$=9){for(var h=[],u=[],o=Math.max(e,t,a,r)+Math.max(l,s,_,i),p=o;p<=n.length;p++){var c=n.slice(p-o,p),g=await module.exports.roc(c,e),f=await module.exports.roc(c,t),v=await module.exports.roc(c,a),m=await module.exports.roc(c,r);g=await module.exports.sma(g,l),f=await module.exports.sma(f,s),v=await module.exports.sma(v,_),m=await module.exports.sma(m,i),h.push(g[g.length-1]+f[f.length-1]+v[v.length-1]+m[m.length-1])}var w=await module.exports.sma(h,$);for(var p in h.splice(0,h.length-w.length),w)u.push([h[p],w[p]]);return u}async function obv(n){for(var e=1,t=[0];e<n.length;e++)n[e][1]>n[e-1][1]&&t.push(t[t.length-1]+n[e][0]),n[e][1]<n[e-1][1]&&t.push(t[t.length-1]-n[e][0]),n[e][1]===n[e-1][1]&&t.push(t[t.length-1]);return t}async function vwap(n,e=n.length){n=n.map(n=>[n[0]*n[1],n[1]]);for(var t=e,a=[];t<=n.length;t++){for(var r=n.slice(t-e,t),l=0,s=0,_=0;_<r.length;_++)l+=r[_][1],s+=r[_][0];a.push(s/l)}return a}async function mom(n,e=10,t){for(var a=e-1,r=[];a<n.length;a++)t?r.push(n[a]/n[a-(e-1)]*100):r.push(n[a]-n[a-(e-1)]);return r}async function mom_osc(n,e=10){e++;for(var t=e,a=[],r=0,l=0;t<=n.length;t++,r=0,l=0){for(var s=1;s<e;s++)n[t-e+(s-1)]<n[t-e+s]?r+=n[t-e+s]:l+=n[t-e+s];a.push((r-l)/(r+l)*100)}return a}async function ha(n){for(var e=[[(n[0][0]+n[0][3])/2,n[0][1],n[0][2],(n[0][0]+n[0][1]+n[0][2]+n[0][3])/4]],t=1;t<n.length;t++)e.push([(e[e.length-1][0]+e[e.length-1][3])/2,Math.max(e[e.length-1][0],e[e.length-1][3],n[t][1]),Math.min(e[e.length-1][0],e[e.length-1][3],n[t][2]),(n[t][0]+n[t][1]+n[t][2]+n[t][3])/4]);return e}async function ren(n,e=1){for(var t=[],a=Math.floor(e)===e?0:e.toString().split(".")[1].length||0,r=Math.ceil(n[0][0]/e*10**a)/10**a*e,l=r-e,s=1;s<n.length;s++){if(n[s][0]>r+e)do t.push([r,r+e,r,r+e]),r+=e,l+=e;while(n[s][0]>r+e);if(n[s][1]<l-e)do t.push([l,l,l-e,l-e]),r-=e,l-=e;while(n[s][1]<l-e)}return t}async function envelope(n,e=10,t=.005){for(var a=e,r=[];a<n.length;a++){var l=await module.exports.sma(n.slice(a-e,a),e);r.push([l[0]*(1+t),l[0],l[0]*(1-t)])}return r}async function chaikin_osc(n,e=3,t=10){for(var a=0,r=[],l=[];a<n.length;a++){var s=(n[a][1]-n[a][2]-(n[a][0]-n[a][1]))/(n[a][0]-n[a][2]);isNaN(s)?l.push(0):l.push(s*n[a][3])}var _=await module.exports.ema(l,e),i=await module.exports.ema(l,t);_.length>i.length?_.splice(0,_.length-i.length):i.splice(0,i.length-_.length);for(var a=0;a<_.length;a++)r.push(_[a]-i[a]);return r}async function fractals(n){for(var e=[[!1,!1],[!1,!1]],t=2;t<n.length-2;t++){var a=n[t-2][0]<n[t][0]&&n[t-1][0]<n[t][0]&&n[t][0]>n[t+1][0]&&n[t][0]>n[t+2][0],r=n[t-2][1]>n[t][1]&&n[t-1][1]>n[t][1]&&n[t][1]<n[t+1][1]&&n[t][1]<n[t+2][1];e.push([a,r])}return e.push([!1,!1],[!1,!1]),e}async function alligator(n,e=13,t=8,a=5,r=8,l=5,s=3){var _=[],i=await module.exports.smma(n,e),$=await module.exports.smma(n,t),h=await module.exports.smma(n,a);$.splice(0,$.length-i.length),h.splice(0,h.length-i.length);for(var u=i.length-1;u>=7;u--)_.push([i[u-(r-1)],$[u-(l-1)],h[u-(s-1)]]);return _}async function gator(n,e=13,t=8,a=5,r=8,l=5,s=3){var _=[],i=await module.exports.smma(n,e),$=await module.exports.smma(n,t),h=await module.exports.smma(n,a);$.splice(0,$.length-i.length),h.splice(0,h.length-i.length);for(var u=i.length-1;u>=r-1;u--)_.push([i[u-(r-1)]-$[u-(l-1)],-Math.abs($[u-(l-1)]-h[u-(s-1)])]);return _}async function recent_high(n,e=25){for(var t=n.length-2,a=e,r=0,l=n[n.length-1];t>=0&&(n[t]>=l&&a>0?(l=n[t],r=t,a=e):a--,!(a<=0));t--);return{index:r,value:l}}async function recent_low(n,e=25){for(var t=n.length-2,a=e,r=0,l=n[n.length-1];t>=0&&(n[t]<=l&&a>0?(l=n[t],r=t,a=e):a--,!(a<=0));t--);return{index:r,value:l}}async function support(n,e=recent_low(n)){var t,a,r=(e=await e).value;do{for(var l=e.index;l<n.length;l++){var s=(e.value-n[l])/(e.index-l);s<r&&(r=s,t=l)}e.index+1==t&&t!=n.length-1?(e.index=t,r=Math.min.apply(null,n.slice()),e.value=n[e.index],a=!1):a=!0,e.index==n.length-1&&(a=!0)}while(!a);return t==n.length-1||e.index==n.length-1?{calculate:async n=>e.value,slope:0,lowest:e.value,index:e.index}:{calculate:async n=>n*r+e.value,slope:r,lowest:e.value,index:e.index}}async function resistance(n,e){var t,a,r=(e=e||await recent_high(n)).value;do{for(var l=e.index;l<n.length;l++){var s=(n[l]-e.value)/(e.index-l);s<r&&(r=s,t=l)}e.index+1==t&&t!=n.length-1?(e.index=t,r=Math.max.apply(null,n.slice()),e.value=n[e.index],a=!1):a=!0,e.index==n.length-1&&(a=!0)}while(!a);return t==n.length-1||e.index==n.length-1?{calculate:async n=>e.value,slope:0,highest:e.value,index:e.index}:{calculate:async n=>-(n*r)+e.value,slope:r,highest:e.value,index:e.index}}async function fisher(n,e){var t=[],a=0,r=0;for(let l=e;l<=n.length;l++){var s=n.slice(l-e,l),_=a,i=Math.min.apply(null,s),r=.66*((n[l-1]-i)/(Math.max.apply(null,s)-i)-.5)+.67*r;r>.99&&(r=.999),r<-.99&&(r=-.999),a=.5*Math.log((1+r)/(1-r))+.5*_,t.push([a,_])}return t.slice(1,t.length)}async function cross(n,e){n.splice(0,n.length-e.length);for(var t=n[0]>e[0],a=[],r=0;r<n.length;r++)n[r]<e[r]&&t&&(a.push({index:r,cross:!1}),t=!1),n[r]>e[r]&&!t&&(a.push({index:r,cross:!0}),t=!0);return a}async function se(n,e){return e=e||n.length,await module.exports.std(n)/e**.5}async function halftrend(n,e,t,a){let r=[],l=[0],s=[0],_=[0],i=[0],$;for(let h=e;h<=n.length;h++){let u=n.slice(h-e,h);maxlow=u[u.length-2][2],minhigh=u[u.length-2][0];let o=a*(atr2=(atr2=await module.exports.atr(u,e))[atr2.length-1]/2),p=Math.max.apply(null,u.slice(u.length-1,u.length).map(n=>n[0])),c=Math.min.apply(null,u.slice(u.length-1,u.length).map(n=>n[2])),g=await module.exports.sma(u.slice(u.length-t,t).map(n=>n[0]),t),f=await module.exports.sma(u.slice(u.length-t,t).map(n=>n[2]),t);if(1==l[l.length-1]?(maxlow=Math.max(c,maxlow),g[0]<maxlow&&u[u.length-1][1]<u[u.length-2][2]&&(s.push(1),l.push(0),minhigh=u[u.length-2][0])):(minhigh=Math.min(p,minhigh),f[0]>minhigh&&u[u.length-1][1]<u[u.length-2][0]&&(s.push(0),l.push(1),maxlow=c)),0==s[s.length-1]){isNaN(s[s.length-2])||0==s[s.length-2]?_.push(isNaN(_[_.length-2])?maxlow:Math.max(_[_.length-2],maxlow)):_.push(isNaN(i[i.length-2])?i[i.length-1]:i[i.length-2]),$="long";var v=_[_.length-1]+o,m=_[_.length-1]-o}else{isNaN(s[s.length-2])||1==s[s.length-2]?i.push(isNaN(i[i.length-2])?minhigh:Math.min(minhigh,i[i.length-2])):i.push(isNaN(_[_.len-2])?_[_.length-1]:_[_.length-2]),$="short";var v=i[i.length-1]+o,m=i[i.length-1]-o}r.push([v,0==s[s.length-1]?_[_.length-1]:i[i.length-1],m,$])}return r}const sum=async n=>n.reduce((n,e)=>n+e);async function covariance(n,e,t){let a=[];await module.exports.sma(n,n.length),await module.exports.sma(e,e.length);for(let r=t;r<=n.length;r++){let l=n.slice(r-t,r),s=e.slice(r-t,r),_=await module.exports.sma(l,t),i=[],$=await module.exports.sma(s,t);for(let h=0;h<t;h++)i.push((l[h]-_[0])*(s[h]-$[0]));i=await module.exports.sum(i),a.push(i/t)}return a}const range=(n,e,t)=>Math.floor(t?t()*(Math.floor(e)-Math.ceil(n))+Math.ceil(n):Math.random()*(Math.floor(e)-Math.ceil(n))+Math.ceil(n)),pick=(n,e)=>n[Math.floor(e?e()*Math.floor(n.length):Math.random()*Math.floor(n.length))],float=(n,e,t)=>t?t()*(e-n)+n:Math.random()*(e-n)+n;function prng(n){for(var e=0,t=1779033703^n.length;e<n.length;e++)t=(t=Math.imul(t^n.charCodeAt(e),3432918353))<<13|t>>>19;return t=Math.imul((t=Math.imul(t^t>>>16,2246822507))^t>>>13,3266489909),n=(t^=t>>>16)>>>0,function(){var e=n+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}}async function ncdf(n,e,t){var a=1/(1+.2315419*Math.abs(n=e||t?(n-e)/t:n)),r=.3989423*Math.exp(-n*n/2)*a*(.3193815+a*(-.3565638+a*(1.781478+a*(-1.821256+1.330274*a))));return n>0?1-r:r}async function zigzag(n,e=.05){let t=[],a=1/0,r=-1/0,l=!1,s=!1,_=[];if(Array.isArray(n[0]))for(let i=0;i<n.length;i++)if(l){t[t.length-1].value>=n[i][1]&&(t[t.length-1].value=n[i][1],t[t.length-1].index=i),a>=n[i][1]&&(a=n[i][1]);(n[i][0]-a)/a>e&&(t.push({index:i,value:n[i][0]}),s=!0,l=!1,a=1/0)}else if(s){t[t.length-1].value<=n[i][0]&&(t[t.length-1].value=n[i][0],t[t.length-1].index=i),r<=n[i][1]&&(r=n[i][1]);(r-n[i][1])/n[i][1]>e&&(t.push({index:i,value:n[i][1]}),l=!0,s=!1,r=-1/0)}else{a>=n[i][1]&&(a=n[i][1]),r<=n[i][0]&&(r=n[i][0]);let $=(n[i][0]-a)/a,h=(r-n[i][1])/r;h>e&&$<e?(l=!0,t.push({index:0,value:n[0][0]}),t.push({index:i,value:n[i][1]})):$>e&&h<e?(s=!0,t.push({index:0,value:n[0][1]}),t.push({index:i,value:n[i][0]})):h>$?(l=!0,t.push({index:0,value:n[0][0]}),t.push({index:i,value:n[i][1]})):(s=!0,t.push({index:0,value:n[0][1]}),t.push({index:i,value:n[i][0]}))}else for(let u=0;u<n.length;u++)if(l){t[t.length-1].value>=n[u]&&(t[t.length-1].value=n[u],t[t.length-1].index=u),a>=n[u]&&(a=n[u]);(n[u]-a)/a>e&&(t.push({index:u,value:n[u]}),s=!0,l=!1,a=1/0)}else if(s){t[t.length-1].value<=n[u]&&(t[t.length-1].value=n[u],t[t.length-1].index=u),r<=n[u]&&(r=n[u]);(r-n[u])/n[u]>e&&(t.push({index:u,value:n[u]}),l=!0,s=!1,r=-1/0)}else{a>=n[u]&&(a=n[u]),r<=n[u]&&(r=n[u]);let o=(n[u]-a)/a,p=(r-n[u])/r;p>e&&o<e?(l=!0,t.push({index:0,value:n[0]}),t.push({index:u,value:n[u]})):o>e&&p<e?(s=!0,t.push({index:0,value:n[0]}),t.push({index:u,value:n[u]})):p>o?(l=!0,t.push({index:0,value:n[0]}),t.push({index:u,value:n[u]})):(s=!0,t.push({index:0,value:n[0]}),t.push({index:u,value:n[u]}))}_=[t[0].value];for(let c=1;c<t.length;c++){let g=t[c].index-t[c-1].index,f=(t[c].value-t[c-1].value)/g;for(let v=1;v<=g;v++)_.push(v*f+t[c-1].value)}return _}async function psar(n,e=.02,t=.2){let a=n[0],r=!0,l=e,s=n[0],_=n[0][1],i=n[0][0],$=[_];for(let h=1;h<n.length;h++)_+=l*(i-_),r?(_=Math.min(_,a[1],s[1]),n[h][0]>i&&(i=n[h][0],l=Math.min(l+e,t))):(_=Math.max(_,a[0],s[0]),n[h][1]<i&&(i=n[h][0],l=Math.min(l+e,t))),(r&&n[h][1]<_||!r&&n[h][0]>_)&&(l=e,_=i,i=(r=!r)?n[h][0]:n[h][1]),a=s,s=n[h],$.push(_);return $}async function fibbands(n,e=20,t=3){for(var a=0,r=[],l=[],s=await module.exports.vwma(n,e);a<n.length;a++)if(r.push(n[a][0]),r.length>=e){var _=await module.exports.std(r,e);l.push(_*t),r.splice(0,1)}for(var a=0,i=[];a<s.length;a++){let $=s[a]+.236*l[a],h=s[a]+.382*l[a],u=s[a]+.5*l[a],o=s[a]+.618*l[a],p=s[a]+.764*l[a],c=s[a]+l[a],g=s[a]-.236*l[a],f=s[a]-.382*l[a],v=s[a]-.5*l[a],m=s[a]-.618*l[a],w=s[a]-.764*l[a],y=s[a]-l[a];i.push([c,p,o,u,h,$,s[a],g,f,v,m,w,y])}return i}async function supertrend(n,e=20,t=3){for(var a=e-1,r=await module.exports.atr(n,e),l=[];a<n.length;a++)l.push([(n[a][0]+n[a][2])/2+t*r[a],(n[a][0]+n[a][2])/2-t*r[a]]);return l}async function cwma(n,e){for(var t=e.length,a=[];t<=n.length;t++){for(var r=n.slice(t-e.length,t),l=0,s=0,_=0;_<e.length;_++)l+=r[_]*e[_],s+=e[_];a.push(l/s)}return a}const fibnumbers=[0,1,1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181],permutations=async n=>n.reduce((n,e)=>n*e);async function mse(n,e){for(var t=0,a=0;t<n.length;t++)a+=Math.pow(e[t]-n[t],2);return a/n.length}async function cum(n,e){for(var t=e,a=[];t<=n.length;t++)a.push(await module.exports.sum(n.slice(t-e,t)));return a}async function vwwma(n,e=20){n=n.map(n=>[n[0]*n[1],n[1]]);for(var t=1,a=0;t<=e;t++)a+=t;for(var t=e,r=[];t<=n.length;t++){var l=n.slice(t-e,t),s=0,_=0;for(q in l)s+=l[q][1]*(Number(q)+1)/a,_+=l[q][0]*(Number(q)+1)/a;r.push(_/s)}return r}async function elderray(n,e=13){for(var t=e,a=[];t<=n.length;t++){var r=n.slice(t-e,t),l=Math.min.apply(void 0,r),s=Math.max.apply(void 0,r),_=await module.exports.ema(r,r.length);a.push([s-_[0],l-_[0]])}return a}async function hv(n,e=10){for(var t=e,a=[];t<=n.length;t++){var r=await ssd(n.slice(t-e,t))/e;a.push(Math.sqrt(r))}return a};const random={range,pick,float,prng};const aroon={up:aroon_up,down:aroon_down,osc:aroon_osc};
