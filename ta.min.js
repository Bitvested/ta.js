/* ta.js (c) Nino Kroesen. MIT License. */ async function median(n,e){for(var t=[],a=e||n.length;a<=n.length;a++){var r=n.slice(a-e,a);r.sort((n,e)=>n-e),t.push(r[Math.round(r.length/2)-1])}return t}async function kmeans(n,e){var t,a=[],r=[],l=[],s=!1,h=Math.round(n.length/(e+1));for(i=0;i<e;i++)r[i]=n[h*(i+1)];do{for(i=0;i<e;i++)a[i]=[];for(x=0;x<n.length;x++){var o=-1;for(y=0;y<e;y++){var u=Math.abs(r[y]-n[x]);-1===o?(o=u,t=y):u<=o&&(o=u,t=y)}a[t].push(n[x])}for(l=r,x=0;x<e;x++){var p=0;for(y=0;y<a[x].length;y++)p+=a[x][y];var c=p/a[t].length;r[x]=c}for(x=0;x<e;x++)r[x]!==l[x]&&(s=!0)}while(s);return a}async function normalize(n,e){e=e||0;for(var t=await Math.max.apply(null,n.slice())*(1+e),a=await Math.min.apply(null,n.slice())*(1-e),r=[],l=0;l<n.length;l++)r.push(1-(t-n[l])/(t-a));return r}async function denormalize(n,e,t){t=t||0;for(var a=await Math.max.apply(null,n.slice())*(1+t),r=await Math.min.apply(null,n.slice())*(1-t),l=[],s=0;s<e.length;s++)l.push(r+e[s]*(a-r));return l}async function normalize_pair(n,e){for(var t=(n[0]+e[0])/2,a=[[t,t]],r=1;r<n.length;r++)a.push([a[a.length-1][0]*((n[r]-n[r-1])/n[r-1]+1),a[a.length-1][1]*((e[r]-e[r-1])/e[r-1]+1)]);return a}async function normalize_from(n,e){for(var t=[e],a=1;a<n.length;a++)t.push(t[t.length-1]*((n[a]-n[a-1])/n[a-1]+1));return t}async function normalize_return(n,e){for(var t=[],a=0;a<n.length;a++)t.push(n[a]-e[a]);return t}async function standardize(n){for(var e=await sma(n,n.length),t=await std(n),a=[],r=0;r<n.length;r++)a.push((n[r]-e[0])/t);return a}async function mad(n,e){for(var t=e||n.length,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=await median(l),h=l.map(n=>Math.abs(n-s[s.length-1]));h=await median(h),a.push(h[h.length-1])}return a}async function aad(n,e){for(var t=e||n.length,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=0,h=await sma(l,t);for(q in l)s+=Math.abs(l[q]-h[h.length-1]);a.push(s/t)}return a}async function ssd(n,e){for(var t=e||n.length,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=await sma(l,t),h=0;for(let n in l)h+=(l[n]-s[s.length-1])**2;a.push(Math.sqrt(h))}return a}async function er(n){var e=[],t=[],a=1,r=1;for(let a in n)n[a]>=0?e.push(1+n[a]):t.push(1+n[a]);var l=e.length/n.length,s=t.length/n.length;for(let n in t)r*=t[n];for(let n in e)a*=e[n];return(100*(a**(1/e.length)-1)*l+100*(r**(1/t.length)-1)*s)/100}async function ar(n,e){for(var t=[],a=e;a<n.length;a++){var r=await er(n.slice(a-e,a));t.push(n[a]-r)}return t}async function kelly(n){var e=await er(n)+1,t=await winratio(n);return t-(1-t)/e}async function winratio(n){var e=0,t=0;for(let a in n)n[a]>=0?e++:t++;return e/(t+e)}async function avgwin(n){for(var e=[],t=0;t<n.length;t++)n[t]>=0&&e.push(n[t]);return(await sma(e,e.length))[0]}async function avgloss(n){for(var e=[],t=0;t<n.length;t++)n[t]<0&&e.push(n[t]);return(await sma(e,e.length))[0]}async function zscore(n,e){var t=[],a=n.slice(0,e-1);for(let s=e-1;s<n.length;s++){a.push(n[s]);var r=await sma(a,e),l=await std(a,e);t.push((n[s]-r[0])/l),a.splice(0,1)}return t}async function rsi(n,e){for(var t=e||14,a=[],r=n.slice(0,t),l=t,s=0,h=0;l<n.length;l++,s=0,h=0){r.push(n[l]);for(var o=1;o<r.length;o++)r[o]-r[o-1]<0?h+=Math.abs(r[o]-r[o-1]):s+=r[o]-r[o-1];var u=100-100/(1+s/t/(h/t));a.push(u),r.splice(0,1)}return a}async function wrsi(n,e){for(var t=e||14,a=[],r=[],l=[],s=1;s<n.length;s++)n[s]-n[s-1]<0?(l.push(Math.abs(n[s]-n[s-1])),r.push(0)):(l.push(0),r.push(n[s]-n[s-1]));l=await wsma(l,t),r=await wsma(r,t);for(let n in l)a.push(100-100/(1+r[n]/l[n]));return a}async function tsi(n,e,t,a){for(var r=e||25,l=t||13,s=a||13,h=[],o=[],u=[],i=[],p=1;p<n.length;p++)h.push(n[p]-n[p-1]),o.push(Math.abs(n[p]-n[p-1]));var c=await ema(h,r),g=await ema(o,r),f=await ema(c,l),m=await ema(g,l);for(p=0;p<f.length;p++)u.push(f[p]/m[p]);var v=await ema(u,s);u.splice(0,u.length-v.length);for(p=0;p<v.length;p++)i.push([v[p],u[p]]);return i}async function bop(n,e){var t=n.map(n=>(n[3]-n[0])/(n[1]-n[2]));e=e||14;return t=await sma(t,e)}async function fi(n,e){for(var t=e||13,a=[],r=[],l=1;l<n.length;l++)if(a.push((n[l][0]-n[l-1][0])*n[l][1]),a.length>=t){var s=await ema(a,t);r.push(s[s.length-1]),a.splice(0,1)}return r}async function asi(n){for(var e=[],t=1;t<n.length;t++){var a,r=n[t][1],l=n[t-1][1],s=n[t][0],h=n[t-1][0],o=n[t][2],u=n[t-1][2],i=h-r>u-r?h-r:u-r,p=n[t][0],c=n[t-1][0],g=Math.max(n[t][0],n[t-1][0])-Math.min(n[t][2],n[t-1][2]);s-l>o-l&&s-l>s-o&&(a=s-l-(o-l)/2+(l-c)/4),o-l>s-l&&o-l>s-o&&(a=o-l-(s-l)/2+(l-c)/4),s-o>s-l&&s-o>o-l&&(a=s-o+(l-c)/4),e.push((l-r+(l-c)/2+(r-p)/2)/a*50*i/g)}return e}async function ao(n,e,t){var a=e||5,r=t||35,l=[];n=n.map(n=>(n[0]+n[1])/2);for(var s=r;s<=n.length;s++){var h=n.slice(s-r,s),o=await sma(h,a),u=await sma(h,r);l.push(o[o.length-1]-u[u.length-1])}return l}async function ac(n,e,t){e=e||5,t=t||35;var a=await ao(n,e,t),r=await sma(a,e),l=[];a.length>r.length?a.splice(0,a.length-r.length):r.splice(0,r.length-a.length);for(let n in a)l.push(a[n]-r[n]);return l}async function fib(n,e){return[n,.236*(e-n)+n,.382*(e-n)+n,.5*(e-n)+n,.618*(e-n)+n,.786*(e-n)+n,e,1.618*(e-n)+n,2.618*(e-n)+n,3.618*(e-n)+n,4.236*(e-n)+n]}async function pr(n,e){for(var t=e||14,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=await Math.max.apply(null,l),h=await Math.min.apply(null,l);a.push((s-n[r-1])/(s-h)*-100)}return a}async function lsma(n,e){for(var t=e||25,a=[],r=t;r<=n.length;r++){for(var l,s,h=n.slice(r-t,r),o=0,u=0,i=0,p=0,c=1;c<=t;c++)o+=c,u+=h[c-1],i+=h[c-1]*c,p+=c*c,h[c-1]*h[c-1];s=u/t-(l=(i-o*u/t)/(p-o*o/t))*o/t,a.push(l*t+s)}return a}async function don(n,e){for(var t=[],a=e||20,r=a;r<=n.length;r++){var l=n.slice(r-a,r),s=[],h=[];for(let n in l)s.push(l[n][0]),h.push(l[n][1]);var o=Math.max.apply(null,s.slice()),u=Math.min.apply(null,h.slice());t.push([o,(o+u)/2,u])}return t}async function ichimoku(n,e,t,a,r){for(var l=[],s=e||9,h=t||26,o=a||52,u=r||26,i=[],p=[],c=0;c<n.length;c++)if(l.push(n[c]),l.length>=o){var g=[],f=[];for(let n in l)g.push(l[n][0]),f.push(l[n][2]);var m=(Math.max.apply(null,g.slice(g.length-s,g.length))+Math.min.apply(null,f.slice(f.length-s,f.length)))/2,v=(Math.max.apply(null,g.slice(g.length-h,g.length))+Math.min.apply(null,f.slice(f.length-h,f.length)))/2,d=n[c][1]+v,x=(Math.max.apply(null,g.slice(g.length-o,g.length))+Math.min.apply(null,f.slice(f.length-h,f.length)))/2;chik=n[c][1],p.push([m,v,d,x,chik]),l.splice(0,1)}for(c=u;c<p.length-u;c++)i.push([p[c][0],p[c][1],p[c+u][2],p[c+u][3],p[c-u][4]]);return i}async function stoch(n,e,t,a){var r=e||14,l=t||3,s=a||3,h=[],o=[],u=[],i=[];r<l&&([r,l]=[l,r]),s>l&&([s,l]=[l,s]);for(var p=0;p<n.length;p++){if(o.push(n[p][0]),u.push(n[p][2]),o.length>=r){var c=await Math.max.apply(null,o),g=await Math.min.apply(null,u),f=100*(n[p][1]-g)/(c-g);i.push(f)}if(s>0&&i.length>s){var m=await sma(i,s);i.push(m[m.length-1])}if(i.length-s>=l){var v=await sma(i,l);h.push([f,v[v.length-1]]),o.splice(0,1),u.splice(0,1),i.splice(0,1)}}return h}async function atr(n,e){for(var t=e||14,a=[n[0][0]-n[0][2]],r=1;r<n.length;r++){var l=await Math.max(n[r][0]-n[r-1][1],n[r][2]-n[r-1][1],n[r][0]-n[r][2]);a.push((a[a.length-1]*(t-1)+l)/t)}return a}async function sma(n,e){for(var t=e||14,a=[],r=t,l=0;r<=n.length;r++,l=0){var s=n.slice(r-t,r);for(q in s)l+=s[q];a.push(l/t)}return a}async function smma(n,e){for(var t=e||14,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=0;for(q in l)s+=l[q];a.length<=0?a.push(s/t):a.push((s-a[a.length-1])/t)}return a.splice(0,1),a}async function wma(n,e){for(var t=e||14,a=0,r=[],l=1;l<=t;l++)a+=l;for(l=t;l<=n.length;l++){var s=n.slice(l-t,l),h=0;for(q in s)h+=s[q]*(Number(q)+1)/a;r.push(h)}return r}async function wsma(n,e){for(var t=e||14,a=[],r=1/t,l=t;l<=n.length;l++)if(a.length>0)a.push((n[l-1]-a[a.length-1])*r+a[a.length-1]);else{var s=n.slice(l-t,l),h=0;for(q in s)h+=s[q];a.push(h/t)}return a}async function pwma(n,e){for(var t=0,a=[],r=[],l=e||14,s=l/2,h=e;s>=1;s--,h--)s%1!=0?t+=(s=Math.round(s))*h:(r.push(s*h),t+=s*h*2),r.unshift(s*h);for(s=l;s<=n.length;s++){for(var o=0,u=n.slice(s-l,s),i=l-1;i>=0;i--)o+=u[i]*r[i]/t;a.push(o)}return a}async function hwma(n,e){for(var t=0,a=[],r=[],l=e||14,s=1,h=l;s<=l/2;s++,h--)s%1!=0?t+=(s=Math.round(s))*h:(r.push(s*h),t+=s*h*2),r.unshift(s*h);for(s=l;s<=n.length;s++){for(var o=0,u=n.slice(s-l,s),i=l-1;i>=0;i--)o+=u[i]*r[i]/t;a.push(o)}return a}async function vwma(n,e){for(var t=e||20,a=[],r=(n=n.map(n=>[n[0]*n[1],n[1]]),t);r<=n.length;r++){for(var l=n.slice(r-t,r),s=0,h=0,o=0;o<l.length;o++)s+=l[o][1],h+=l[o][0];a.push(h/s)}return a}async function ema(n,e){for(var t=e||12,a=[],r=2/(t+1),l=t;l<=n.length;l++)if(a.length>0)a.push((n[l-1]-a[a.length-1])*r+a[a.length-1]);else{var s=n.slice(l-t,l),h=0;for(q in s)h+=s[q];a.push(h/t)}return a}async function hull(n,e){var t=e||14,a=[],r=[],l=await wma(n,t),s=Math.round(Math.sqrt(t)),h=await wma(n,Math.round(t/2));h.splice(0,h.length-l.length);for(let n in l)if(a.push(2*h[n]-l[n]),a.length>=s){var o=await wma(a,s);r.push(o[0]),a.splice(0,1)}return r}async function kama(n,e,t,a){e=e||10,t=t||2,a=a||30;for(var r=[(r=await sma(n,e))[r.length-1]],l=e+1;l<n.length;l++){for(var s=0,h=Math.abs(n[l]-n[l-e]),o=1;o<e;o++)s+=Math.abs(n[l-o]-n[l-o-1]);var u=(h/s*(2/(t+1)-2/(a+1)+2/(a+1)))**2;r.push(r[r.length-1]+u*(n[l]-r[r.length-1]))}return r}async function macd(n,e,t){var a=e||12,r=t||26;a>r&&([a,r]=[r,a]);var l=await ema(n,a),s=await ema(n,r),h=[];l.splice(0,r-a);for(var o=0;o<s.length;o++)h.push(l[o]-s[o]);return h}async function bands(n,e,t){for(var a=e||14,r=t||1,l=[],s=[],h=[],o=await sma(n,a),u=0;u<n.length;u++)if(l.push(n[u]),l.length>=a){var i=await std(l,a);s.push(i),l.splice(0,1)}for(u=0;u<o.length;u++)h.push([o[u]+s[u]*r,o[u],o[u]-s[u]*r]);return h}async function bandwidth(n,e,t){for(var a=e||14,r=t||1,l=[],s=await bands(n,a,r),h=0;h<s.length;h++)l.push((s[h][0]-s[h][2])/s[h][1]);return l}async function keltner(n,e,t){var a,r=e||14,l=t||1,s=[],h=await atr(n,r),o=[];for(var u in n)s.push((n[u][0]+n[u][1]+n[u][2])/3);a=await sma(s,r),h.splice(0,r-1);for(u=0;u<a.length;u++)o.push([a[u]+h[u]*l,a[u],a[u]-h[u]*l]);return o}async function variance(n,e){for(var t=e||n.length,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=await sma(l,t),h=0;for(x in l)h+=(l[x]-s[s.length-1])**2;a.push(h/t)}return a}async function std(n,e){var t=e||n.length,a=n.reduce((n,e)=>Number(n)+Number(e))/t;return Math.sqrt(n.reduce((n,e)=>n+Math.pow(e-a,2),0)/t)}async function normsinv(n){var e=-.00778489400243029,t=-.322396458041136,a=-2.40075827716184,r=-2.54973253934373,l=4.37466414146497,s=2.93816398269878,h=.00778469570904146,o=.32246712907004,u=2.445134137143,i=3.75440866190742;if(n<0||n>1)return 0;if(n<.02425)return(((((e*(p=Math.sqrt(-2*Math.log(n)))+t)*p+a)*p+r)*p+l)*p+s)/((((h*p+o)*p+u)*p+i)*p+1);if(n<=.97575){var p,c=(p=n-.5)*p;return(((((-39.6968302866538*c+220.946098424521)*c-275.928510446969)*c+138.357751867269)*c-30.6647980661472)*c+2.50662827745924)*p/(((((-54.4760987982241*c+161.585836858041)*c-155.698979859887)*c+66.8013118877197)*c-13.2806815528857)*c+1)}return-(((((e*(p=Math.sqrt(-2*Math.log(1-n)))+t)*p+a)*p+r)*p+l)*p+s)/((((h*p+o)*p+u)*p+i)*p+1)}async function sim(n,e,t,a){for(var r=[],l=(e=e||50,t=t||1e3,0);l<t;l++){for(var s=n.slice(),h=0;h<e;h++){for(var o=[],u=1;u<s.length;u++){var i=await dif(s[u],s[u-1]);o.push(i)}var p=await sma(o,o.length),c=await std(o),g=await normsinv(Math.random());s.push(s[s.length-1]*Math.exp(p[0]-c*c/2+c*g))}r.push(s)}return a?await percentile(r,a):r}async function percentile(n,e){for(var t=[],a=0;a<n[0].length;a++)n.sort((n,e)=>n[a]-e[a]),t.push(n[Math.round((n.length-1)*e)][a]);return t}async function cor(n,e){for(var t=await sma(n,n.length),a=await sma(e,e.length),r=0,l=0,s=0,h=0;h<n.length;h++){var o=n[h]-t,u=e[h]-a;r+=o*u,l+=Math.pow(o,2),s+=Math.pow(u,2)}var i=n.length-1;return l/=i,s/=i,r/(i*(l=Math.sqrt(l))*(s=Math.sqrt(s)))}async function dif(n,e){return(n-e)/e}async function log(n){return n.map(n=>Math.log(n))}async function exp(n){return n.map(n=>Math.exp(n))}async function drawdown(n){for(var e=n[0],t=n[0],a=0,r=1;r<n.length;r++){if(n[r]>e){if(0!=t)(l=await dif(t,e))<a&&(a=l),t=n[r];e=n[r]}n[r]<t&&(t=n[r])}var l;return(l=await dif(t,e))<a&&(a=l),a}async function aroon_up(n,e){for(var t=e||10,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=l.slice();s.sort((n,e)=>n-e),a.push(100*(t-1-l.reverse().findIndex(n=>n===s[t-1]))/(t-1))}return a}async function aroon_down(n,e){for(var t=e||10,a=[],r=t;r<=n.length;r++){var l=n.slice(r-t,r),s=l.slice();s.sort((n,e)=>n-e),a.push(100*(t-1-l.reverse().findIndex(n=>n===s[0]))/(t-1))}return a}async function aroon_osc(n,e){for(var t=e||25,a=[],r=await aroon.up(n,t),l=await aroon.down(n,t),s=0;s<r.length;s++)a.push(r[s]-l[s]);return a}async function mfi(n,e){for(var t=e||14,a=[],r=n.map(n=>n[1]),l=n.map(n=>n[0]),s=t;s<=n.length;s++){var h=0,o=0;for(q=s-t;q<s;q++)h+=l[q],o+=r[q];a.push(100-100/(1+h/o))}return a}async function roc(n,e){for(var t=e||14,a=[],r=t;r<=n.length;r++)a.push((n[r-1]-n[r-t])/n[r-t]);return a}async function cop(n,e,t,a){e=e||11,t=t||14,a=a||10,max=Math.max(e,t),co=[];for(var r=max+a;r<n.length;r++){var l=n.slice(r-(max+a),r),s=l.slice(),h=[];l=await roc(l,e),s=await roc(s,t),l.splice(0,l.length-s.length),s.splice(0,s.length-l.length);for(var o=0;o<l.length;o++)h.push(l[o]+s[o]);h=await wma(h,a),co.push(h[h.length-1])}return co}async function kst(n,e,t,a,r,l,s,h,o,u){e=e||10,t=t||15,a=a||20,r=r||30,l=l||10,s=s||10,h=h||10,o=o||15,u=u||9;for(var i=[],p=[],c=Math.max(e,t,a,r)+Math.max(l,s,h,o),g=c;g<=n.length;g++){var f=n.slice(g-c,g),m=await roc(f,e),v=await roc(f,t),d=await roc(f,a),x=await roc(f,r);m=await sma(m,l),v=await sma(v,s),d=await sma(d,h),x=await sma(x,o),i.push(m[m.length-1]+v[v.length-1]+d[d.length-1]+x[x.length-1])}var w=await sma(i,u);for(var g in i.splice(0,i.length-w.length),w)p.push([i[g],w[g]]);return p}async function obv(n){for(var e=[0],t=1;t<n.length;t++)n[t][1]>n[t-1][1]&&e.push(e[e.length-1]+n[t][0]),n[t][1]<n[t-1][1]&&e.push(e[e.length-1]-n[t][0]),n[t][1]===n[t-1][1]&&e.push(e[e.length-1]);return e}async function vwap(n,e){for(var t=!e||e>n.length?n.length:e,a=(n=n.map(n=>[n[0]*n[1],n[1]]),[]),r=t;r<=n.length;r++){for(var l=n.slice(r-t,r),s=0,h=0,o=0;o<l.length;o++)s+=l[o][1],h+=l[o][0];a.push(h/s)}return a}async function mom(n,e,t){for(var a=e||10,r=[],l=a-1;l<n.length;l++)t?r.push(n[l]/n[l-(a-1)]*100):r.push(n[l]-n[l-(a-1)]);return r}async function mom_osc(n,e){for(var t=e?e+1:10,a=[],r=t;r<=n.length;r++){for(var l=0,s=0,h=1;h<t;h++)n[r-t+(h-1)]<n[r-t+h]?l+=n[r-t+h]:s+=n[r-t+h];a.push((l-s)/(l+s)*100)}return a}async function ha(n){for(var e=[[(Number(n[0][0])+Number(n[0][3]))/2,Number(n[0][1]),Number(n[0][2]),(Number(n[0][0])+Number(n[0][1])+Number(n[0][2])+Number(n[0][3]))/4]],t=1;t<n.length;t++)e.push([(e[e.length-1][0]+e[e.length-1][3])/2,Math.max(e[e.length-1][0],e[e.length-1][3],n[t][1]),Math.min(e[e.length-1][0],e[e.length-1][3],n[t][2]),(n[t][0]+n[t][1]+n[t][2]+n[t][3])/4]);return e}async function ren(n,e){for(var t=[],a=(e=e||1,Math.floor(e)===e?0:e.toString().split(".")[1].length||0),r=Math.ceil(n[0][0]/e*10**a)/10**a*e,l=r-e,s=1;s<n.length;s++){if(n[s][0]>r+e)do{t.push([r,r+e,r,r+e]),r+=e,l+=e}while(n[s][0]>r+e);if(n[s][1]<l-e)do{t.push([l,l,l-e,l-e]),r-=e,l-=e}while(n[s][1]<l-e)}return t}async function envelope(n,e,t){t=t||.005;for(var a=[],r=e=e||10;r<n.length;r++){var l=await sma(n.slice(r-e,r),e);a.push([l[0]*(1+t),l[0],l[0]*(1-t)])}return a}async function chaikin_osc(n,e,t){e=e||3,t=t||10;for(var a=[],r=[],l=0;l<n.length;l++){var s=(n[l][1]-n[l][2]-(n[l][0]-n[l][1]))/(n[l][0]-n[l][2]);isNaN(s)?r.push(0):r.push(s*n[l][3])}var h=await ema(r,e),o=await ema(r,t);h.length>o.length?h.splice(0,h.length-o.length):o.splice(0,o.length-h.length);for(l=0;l<h.length;l++)a.push(h[l]-o[l]);return a}async function fractals(n){for(var e=[[!1,!1],[!1,!1]],t=2;t<n.length-2;t++){var a=n[t-2][0]<n[t][0]&&n[t-1][0]<n[t][0]&&n[t][0]>n[t+1][0]&&n[t][0]>n[t+2][0],r=n[t-2][1]>n[t][1]&&n[t-1][1]>n[t][1]&&n[t][1]<n[t+1][1]&&n[t][1]<n[t+2][1];e.push([a,r])}return e.push([!1,!1],[!1,!1]),e}async function alligator(n,e,t,a,r,l,s){e=e||13,t=t||8,a=a||5,r=r||8,l=l||5,s=s||3;var h=[],o=await smma(n,e),u=await smma(n,t),i=await smma(n,a);u.splice(0,u.length-o.length),i.splice(0,i.length-o.length);for(var p=o.length-1;p>=7;p--)h.push([o[p-(r-1)],u[p-(l-1)],i[p-(s-1)]]);return h}async function gator(n,e,t,a,r,l,s){e=e||13,t=t||8,a=a||5,r=r||8,l=l||5,s=s||3;var h=[],o=await smma(n,e),u=await smma(n,t),i=await smma(n,a);u.splice(0,u.length-o.length),i.splice(0,i.length-o.length);for(var p=o.length-1;p>=r-1;p--)h.push([o[p-(r-1)]-u[p-(l-1)],-Math.abs(u[p-(l-1)]-i[p-(s-1)])]);return h}async function recent_high(n,e){for(var t=e=e||25,a=0,r=n[n.length-1],l=n.length-2;l>=0&&(n[l]>=r&&t>0?(r=n[l],a=l,t=e):t--,!(t<=0));l--);return{index:a,value:r}}async function recent_low(n,e){for(var t=e=e||25,a=0,r=n[n.length-1],l=n.length-2;l>=0&&(n[l]<=r&&t>0?(r=n[l],a=l,t=e):t--,!(t<=0));l--);return{index:a,value:r}}async function support(n,e){var t,a,r=(e=e||await recent_low(n)).value;do{for(var l=e.index;l<n.length;l++){var s=(e.value-n[l])/(e.index-l);s<r&&(r=s,t=l)}e.index+1==t&&t!=n.length-1?(e.index=t,r=Math.min.apply(null,n.slice()),e.value=n[e.index],a=!1):a=!0,e.index==n.length-1&&(a=!0)}while(!a);return t==n.length-1||e.index==n.length-1?{calculate:async n=>e.value,slope:0,lowest:e.value,index:e.index}:{calculate:async n=>n*r+e.value,slope:r,lowest:e.value,index:e.index}}async function resistance(n,e){var t,a,r=(e=e||await recent_high(n)).value;do{for(var l=e.index;l<n.length;l++){var s=(n[l]-e.value)/(e.index-l);s<r&&(r=s,t=l)}e.index+1==t&&t!=n.length-1?(e.index=t,r=Math.max.apply(null,n.slice()),e.value=n[e.index],a=!1):a=!0,e.index==n.length-1&&(a=!0)}while(!a);return t==n.length-1||e.index==n.length-1?{calculate:async n=>e.value,slope:0,highest:e.value,index:e.index}:{calculate:async n=>n*-r+e.value,slope:r,highest:e.value,index:e.index}}async function fisher(n,e){var t=[],a=0,r=0;for(let o=e;o<n.length;o++){var l=n.slice(o-e,o),s=a,h=Math.min.apply(null,l);(r=.66*((n[o]-h)/(Math.max.apply(null,l)-h)-.5)+.67*r)>.99&&(r=.999),r<-.99&&(r=-.999),a=.5*Math.log((1+r)/(1-r))+.5*s,t.push([a,s])}return t.slice(1,t.length)}async function cross(n,e){n.splice(0,n.length-e.length);for(var t=n[0]>e[0],a=[],r=0;r<n.length;r++)n[r]<e[r]&&t&&(a.push({index:r,cross:!1}),t=!1),n[r]>e[r]&&!t&&(a.push({index:r,cross:!0}),t=!0);return a}async function se(n,e){return e=e||n.length,await std(n)/e**.5}async function halftrend(n,e,t,a){let r=[],l=[0],s=[0],h=[0],o=[0],u=void 0;for(let c=e;c<n.length;c++){let g=n[c-1][2],f=n[c-1][0],m=await atr(n.slice(c-e,c),e),v=a*(m=m[m.length-1]/2),d=Math.max.apply(null,n.slice(c-1,c).map(n=>n[0])),x=Math.min.apply(null,n.slice(c-1,c).map(n=>n[2])),w=await sma(n.slice(c-t,c).map(n=>n[0]),t),y=await sma(n.slice(c-t,c).map(n=>n[2]),t);if(1==l[l.length-1]?(g=Math.max(x,g),w[0]<g&&n[c][1]<n[c-1][2]&&(s.push(1),l.push(0),f=n[c-1][0])):(f=Math.min(d,f),y[0]>f&&n[c][1]<n[c-1][0]&&(s.push(0),l.push(1),g=x)),0==s[s.length-1]){isNaN(s[s.length-2])||0==s[s.length-2]?h.push(isNaN(h[h.length-2])?g:Math.max(h[h.length-2],g)):h.push(isNaN(o[o.length-2])?o[o.length-1]:o[o.length-2]),u="long";var i=h[h.length-1]+v,p=h[h.length-1]-v}else{isNaN(s[s.length-2])||1==s[s.length-2]?o.push(isNaN(o[o.length-2])?f:Math.min(f,o[o.length-2])):o.push(isNaN(h[h.len-2])?h[h.length-1]:h[h.length-2]),u="short";i=o[o.length-1]+v,p=o[o.length-1]-v}r.push([i,0==s[s.length-1]?h[h.length-1]:o[o.length-1],p,u])}return r}const aroon={up:aroon_up,down:aroon_down,osc:aroon_osc}
