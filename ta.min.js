/* ta.js (c) Nino Kroesen. MIT License. */ async function median(e,t){for(var n=[],a=t||e.length;a<=e.length;a++){var r=e.slice(a-t,a);r.sort((e,t)=>e-t),n.push(r[Math.round(r.length/2)-1])}return n}async function kmeans(e,t){var n,a=[],r=[],l=[],s=!1,h=Math.round(e.length/(t+1));for(i=0;i<t;i++)r[i]=e[h*(i+1)];do{for(i=0;i<t;i++)a[i]=[];for(x=0;x<e.length;x++){var o=-1;for(y=0;y<t;y++){var u=Math.abs(r[y]-e[x]);-1===o?(o=u,n=y):u<=o&&(o=u,n=y)}a[n].push(e[x])}for(l=r,x=0;x<t;x++){var p=0;for(y=0;y<a[x].length;y++)p+=a[x][y];var c=p/a[n].length;r[x]=c}for(x=0;x<t;x++)r[x]!==l[x]&&(s=!0)}while(s);return a}async function normalize(e,t){t=t||0;for(var n=await Math.max.apply(null,e.slice())*(1+t),a=await Math.min.apply(null,e.slice())*(1-t),r=[],l=0;l<e.length;l++)r.push(1-(n-e[l])/(n-a));return r}async function denormalize(e,t,n){n=n||0;for(var a=await Math.max.apply(null,e.slice())*(1+n),r=await Math.min.apply(null,e.slice())*(1-n),l=[],s=0;s<t.length;s++)l.push(r+t[s]*(a-r));return l}async function normalize_pair(e,t){for(var n=(e[0]+t[0])/2,a=[[n,n]],r=1;r<e.length;r++)a.push([a[a.length-1][0]*((e[r]-e[r-1])/e[r-1]+1),a[a.length-1][1]*((t[r]-t[r-1])/t[r-1]+1)]);return a}async function normalize_from(e,t){for(var n=[t],a=1;a<e.length;a++)n.push(n[n.length-1]*((e[a]-e[a-1])/e[a-1]+1));return n}async function standardize(e){for(var t=await sma(e,e.length),n=await std(e),a=[],r=0;r<e.length;r++)a.push((e[r]-t[0])/n);return a}async function mad(e,t){for(var n=t||e.length,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=await median(l),h=l.map(e=>Math.abs(e-s[s.length-1]));h=await median(h),a.push(h[h.length-1])}return a}async function aad(e,t){for(var n=t||e.length,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=0,h=await sma(l,n);for(q in l)s+=Math.abs(l[q]-h[h.length-1]);a.push(s/n)}return a}async function ssd(e,t){for(var n=t||e.length,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=await sma(l,n),h=0;for(let e in l)h+=(l[e]-s[s.length-1])**2;a.push(Math.sqrt(h))}return a}async function er(e){var t=[],n=[],a=1,r=1;for(let a in e)e[a]>=0?t.push(1+e[a]):n.push(1+e[a]);var l=t.length/e.length,s=n.length/e.length;for(let e in n)r*=n[e];for(let e in t)a*=t[e];return(100*(a**(1/t.length)-1)*l+100*(r**(1/n.length)-1)*s)/100}async function ar(e,t){for(var n=[],a=t;a<e.length;a++){var r=await er(e.slice(a-t,a));n.push(e[a]-r)}return n}async function kelly(e){var t=await er(e)+1,n=await winratio(e);return n-(1-n)/t}async function winratio(e){var t=0,n=0;for(let a in e)e[a]>=0?t++:n++;return t/(n+t)}async function avgwin(e){for(var t=[],n=0;n<e.length;n++)e[n]>=0&&t.push(e[n]);return(await sma(t,t.length))[0]}async function avgloss(e){for(var t=[],n=0;n<e.length;n++)e[n]<0&&t.push(e[n]);return(await sma(t,t.length))[0]}async function zscore(e,t){var n=[],a=e.slice(0,t-1);for(let s=t-1;s<e.length;s++){a.push(e[s]);var r=await sma(a,t),l=await std(a,t);n.push((e[s]-r[0])/l),a.splice(0,1)}return n}async function rsi(e,t){for(var n=t||14,a=[],r=e.slice(0,n-1),l=n-1,s=0,h=0;l<e.length;l++,s=0,h=0){r.push(e[l]);for(var o=1;o<r.length;o++)r[o]-r[o-1]<0?h+=Math.abs(r[o]-r[o-1]):s+=r[o]-r[o-1];var u=100-100/(1+s/n/(h/n));a.push(u),r.splice(0,1)}return a}async function wrsi(e,t){for(var n=t||14,a=[],r=[],l=[],s=1;s<e.length;s++)e[s]-e[s-1]<0?(l.push(Math.abs(e[s]-e[s-1])),r.push(0)):(l.push(0),r.push(e[s]-e[s-1]));l=await wsma(l,n),r=await wsma(r,n);for(let e in l)a.push(100-100/(1+r[e]/l[e]));return a}async function tsi(e,t,n,a){for(var r=t||25,l=n||13,s=a||13,h=[],o=[],u=[],i=[],p=1;p<e.length;p++)h.push(e[p]-e[p-1]),o.push(Math.abs(e[p]-e[p-1]));var c=await ema(h,r),g=await ema(o,r),m=await ema(c,l),f=await ema(g,l);for(p=0;p<m.length;p++)u.push(m[p]/f[p]);var v=await ema(u,s);u.splice(0,u.length-v.length);for(p=0;p<v.length;p++)i.push([v[p],u[p]]);return i}async function bop(e,t){var n=e.map(e=>(e[3]-e[0])/(e[1]-e[2]));t=t||14;return n=await sma(n,t)}async function fi(e,t){for(var n=t||13,a=[],r=[],l=1;l<e.length;l++)if(a.push((e[l][0]-e[l-1][0])*e[l][1]),a.length>=n){var s=await ema(a,n);r.push(s[s.length-1]),a.splice(0,1)}return r}async function asi(e){for(var t=[],n=1;n<e.length;n++){var a,r=e[n][1],l=e[n-1][1],s=e[n][0],h=e[n-1][0],o=e[n][2],u=e[n-1][2],i=h-r>u-r?h-r:u-r,p=e[n][0],c=e[n-1][0],g=Math.max(e[n][0],e[n-1][0])-Math.min(e[n][2],e[n-1][2]);s-l>o-l&&s-l>s-o&&(a=s-l-(o-l)/2+(l-c)/4),o-l>s-l&&o-l>s-o&&(a=o-l-(s-l)/2+(l-c)/4),s-o>s-l&&s-o>o-l&&(a=s-o+(l-c)/4),t.push((l-r+(l-c)/2+(r-p)/2)/a*50*i/g)}return t}async function ao(e,t,n){var a=t||5,r=n||35,l=[];e=e.map(e=>(e[0]+e[1])/2);for(var s=r;s<=e.length;s++){var h=e.slice(s-r,s),o=await sma(h,a),u=await sma(h,r);l.push(o[o.length-1]-u[u.length-1])}return l}async function ac(e,t,n){t=t||5,n=n||35;var a=await ao(e,t,n),r=await sma(a,t),l=[];a.length>r.length?a.splice(0,a.length-r.length):r.splice(0,r.length-a.length);for(let e in a)l.push(a[e]-r[e]);return l}async function fib(e,t){return[e,.236*(t-e)+e,.382*(t-e)+e,.5*(t-e)+e,.618*(t-e)+e,.786*(t-e)+e,t,1.618*(t-e)+e,2.618*(t-e)+e,3.618*(t-e)+e,4.236*(t-e)+e]}async function pr(e,t){for(var n=t||14,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=await Math.max.apply(null,l),h=await Math.min.apply(null,l);a.push((s-e[r-1])/(s-h)*-100)}return a}async function lsma(e,t){for(var n=t||25,a=[],r=n;r<=e.length;r++){for(var l,s,h=e.slice(r-n,r),o=0,u=0,i=0,p=0,c=1;c<=n;c++)o+=c,u+=h[c-1],i+=h[c-1]*c,p+=c*c,h[c-1]*h[c-1];s=u/n-(l=(i-o*u/n)/(p-o*o/n))*o/n,a.push(l*n+s)}return a}async function don(e,t){for(var n=[],a=t||20,r=a;r<=e.length;r++){var l=e.slice(r-a,r),s=[],h=[];for(let e in l)s.push(l[e][0]),h.push(l[e][1]);var o=Math.max.apply(null,s.slice()),u=Math.min.apply(null,h.slice());n.push([o,(o+u)/2,u])}return n}async function ichimoku(e,t,n,a,r){for(var l=[],s=t||9,h=n||26,o=a||52,u=r||26,i=[],p=[],c=0;c<e.length;c++)if(l.push(e[c]),l.length>=o){var g=[],m=[];for(let e in l)g.push(l[e][0]),m.push(l[e][2]);var f=(Math.max.apply(null,g.slice(g.length-s,g.length))+Math.min.apply(null,m.slice(m.length-s,m.length)))/2,v=(Math.max.apply(null,g.slice(g.length-h,g.length))+Math.min.apply(null,m.slice(m.length-h,m.length)))/2,x=e[c][1]+v,d=(Math.max.apply(null,g.slice(g.length-o,g.length))+Math.min.apply(null,m.slice(m.length-h,m.length)))/2;chik=e[c][1],p.push([f,v,x,d,chik]),l.splice(0,1)}for(c=u;c<p.length-u;c++)i.push([p[c][0],p[c][1],p[c+u][2],p[c+u][3],p[c-u][4]]);return i}async function stoch(e,t,n,a){var r=t||14,l=n||3,s=a||3,h=[],o=[],u=[],i=[];r<l&&([r,l]=[l,r]),s>l&&([s,l]=[l,s]);for(var p=0;p<e.length;p++){if(o.push(e[p][0]),u.push(e[p][2]),o.length>=r){var c=await Math.max.apply(null,o),g=await Math.min.apply(null,u),m=100*(e[p][1]-g)/(c-g);i.push(m)}if(s>0&&i.length>s){var f=await sma(i,s);i.push(f[f.length-1])}if(i.length-s>=l){var v=await sma(i,l);h.push([m,v[v.length-1]]),o.splice(0,1),u.splice(0,1),i.splice(0,1)}}return h}async function atr(e,t){for(var n=t||14,a=[e[0][0]-e[0][2]],r=1;r<e.length;r++){var l=await Math.max(e[r][0]-e[r-1][1],e[r][2]-e[r-1][1],e[r][0]-e[r][2]);a.push((a[a.length-1]*(n-1)+l)/n)}return a}async function sma(e,t){for(var n=t||14,a=[],r=n;r<=e.length;r++){let t=await sum(e.slice(r-n,r));a.push(t/n)}return a}async function smma(e,t){for(var n=t||14,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=0;for(q in l)s+=l[q];a.length<=0?a.push(s/n):a.push((s-a[a.length-1])/n)}return a.splice(0,1),a}async function wma(e,t){for(var n=t||14,a=0,r=[],l=1;l<=n;l++)a+=l;for(l=n;l<=e.length;l++){var s=e.slice(l-n,l),h=0;for(q in s)h+=s[q]*(Number(q)+1)/a;r.push(h)}return r}async function wsma(e,t){for(var n=t||14,a=[],r=1/n,l=n;l<=e.length;l++)if(a.length>0)a.push((e[l-1]-a[a.length-1])*r+a[a.length-1]);else{var s=e.slice(l-n,l),h=0;for(q in s)h+=s[q];a.push(h/n)}return a}async function pwma(e,t){for(var n=0,a=[],r=[],l=t||14,s=l/2,h=t;s>=1;s--,h--)s%1!=0?n+=(s=Math.round(s))*h:(r.push(s*h),n+=s*h*2),r.unshift(s*h);for(s=l;s<=e.length;s++){for(var o=0,u=e.slice(s-l,s),i=l-1;i>=0;i--)o+=u[i]*r[i]/n;a.push(o)}return a}async function hwma(e,t){for(var n=0,a=[],r=[],l=t||14,s=1,h=l;s<=l/2;s++,h--)s%1!=0?n+=(s=Math.round(s))*h:(r.push(s*h),n+=s*h*2),r.unshift(s*h);for(s=l;s<=e.length;s++){for(var o=0,u=e.slice(s-l,s),i=l-1;i>=0;i--)o+=u[i]*r[i]/n;a.push(o)}return a}async function vwma(e,t){for(var n=t||20,a=[],r=(e=e.map(e=>[e[0]*e[1],e[1]]),n);r<=e.length;r++){for(var l=e.slice(r-n,r),s=0,h=0,o=0;o<l.length;o++)s+=l[o][1],h+=l[o][0];a.push(h/s)}return a}async function ema(e,t){for(var n=t||12,a=[],r=2/(n+1),l=n;l<=e.length;l++)if(a.length>0)a.push((e[l-1]-a[a.length-1])*r+a[a.length-1]);else{var s=e.slice(l-n,l),h=0;for(q in s)h+=s[q];a.push(h/n)}return a}async function hull(e,t){var n=t||14,a=[],r=[],l=await wma(e,n),s=Math.round(Math.sqrt(n)),h=await wma(e,Math.round(n/2));h.splice(0,h.length-l.length);for(let e in l)if(a.push(2*h[e]-l[e]),a.length>=s){var o=await wma(a,s);r.push(o[0]),a.splice(0,1)}return r}async function kama(e,t,n,a){t=t||10,n=n||2,a=a||30;for(var r=[(r=await sma(e,t))[r.length-1]],l=t+1;l<e.length;l++){for(var s=0,h=Math.abs(e[l]-e[l-t]),o=1;o<t;o++)s+=Math.abs(e[l-o]-e[l-o-1]);var u=(h/s*(2/(n+1)-2/(a+1)+2/(a+1)))**2;r.push(r[r.length-1]+u*(e[l]-r[r.length-1]))}return r}async function macd(e,t,n){var a=t||12,r=n||26;a>r&&([a,r]=[r,a]);var l=await ema(e,a),s=await ema(e,r),h=[];l.splice(0,r-a);for(var o=0;o<s.length;o++)h.push(l[o]-s[o]);return h}async function bands(e,t,n){for(var a=t||14,r=n||1,l=[],s=[],h=[],o=await sma(e,a),u=0;u<e.length;u++)if(l.push(e[u]),l.length>=a){var i=await std(l,a);s.push(i),l.splice(0,1)}for(u=0;u<o.length;u++)h.push([o[u]+s[u]*r,o[u],o[u]-s[u]*r]);return h}async function bandwidth(e,t,n){for(var a=t||14,r=n||1,l=[],s=await bands(e,a,r),h=0;h<s.length;h++)l.push((s[h][0]-s[h][2])/s[h][1]);return l}async function keltner(e,t,n){var a,r=t||14,l=n||1,s=[],h=await atr(e,r),o=[];for(var u in e)s.push((e[u][0]+e[u][1]+e[u][2])/3);a=await sma(s,r),h.splice(0,r-1);for(u=0;u<a.length;u++)o.push([a[u]+h[u]*l,a[u],a[u]-h[u]*l]);return o}async function variance(e,t){for(var n=t||e.length,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=await sma(l,n),h=0;for(x in l)h+=(l[x]-s[s.length-1])**2;a.push(h/n)}return a}async function std(e,t){var n=t||e.length,a=e.reduce((e,t)=>Number(e)+Number(t))/n;return Math.sqrt(e.reduce((e,t)=>e+Math.pow(t-a,2),0)/n)}async function normsinv(e){var t=-.00778489400243029,n=-.322396458041136,a=-2.40075827716184,r=-2.54973253934373,l=4.37466414146497,s=2.93816398269878,h=.00778469570904146,o=.32246712907004,u=2.445134137143,i=3.75440866190742;if(e<0||e>1)return 0;if(e<.02425)return(((((t*(p=Math.sqrt(-2*Math.log(e)))+n)*p+a)*p+r)*p+l)*p+s)/((((h*p+o)*p+u)*p+i)*p+1);if(e<=.97575){var p,c=(p=e-.5)*p;return(((((-39.6968302866538*c+220.946098424521)*c-275.928510446969)*c+138.357751867269)*c-30.6647980661472)*c+2.50662827745924)*p/(((((-54.4760987982241*c+161.585836858041)*c-155.698979859887)*c+66.8013118877197)*c-13.2806815528857)*c+1)}return-(((((t*(p=Math.sqrt(-2*Math.log(1-e)))+n)*p+a)*p+r)*p+l)*p+s)/((((h*p+o)*p+u)*p+i)*p+1)}async function sim(e,t,n,a){for(var r=[],l=(t=t||50,n=n||1e3,0);l<n;l++){for(var s=e.slice(),h=0;h<t;h++){for(var o=[],u=1;u<s.length;u++){var i=await dif(s[u],s[u-1]);o.push(i)}var p=await sma(o,o.length),c=await std(o),g=await normsinv(Math.random());s.push(s[s.length-1]*Math.exp(p[0]-c*c/2+c*g))}r.push(s)}return a?await percentile(r,a):r}async function percentile(e,t){for(var n=[],a=0;a<e[0].length;a++)e.sort((e,t)=>e[a]-t[a]),n.push(e[Math.round((e.length-1)*t)][a]);return n}async function cor(e,t){for(var n=await sma(e,e.length),a=await sma(t,t.length),r=0,l=0,s=0,h=0;h<e.length;h++){var o=e[h]-n,u=t[h]-a;r+=o*u,l+=Math.pow(o,2),s+=Math.pow(u,2)}var i=e.length-1;return l/=i,s/=i,r/(i*(l=Math.sqrt(l))*(s=Math.sqrt(s)))}async function dif(e,t){return(e-t)/t}async function log(e){return e.map(e=>Math.log(e))}async function exp(e){return e.map(e=>Math.exp(e))}async function drawdown(e){for(var t=e[0],n=e[0],a=0,r=1;r<e.length;r++){if(e[r]>t){if(0!=n)(l=await dif(n,t))<a&&(a=l),n=e[r];t=e[r]}e[r]<n&&(n=e[r])}var l;return(l=await dif(n,t))<a&&(a=l),a}async function aroon_up(e,t){for(var n=t||10,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=l.slice();s.sort((e,t)=>e-t),a.push(100*(n-1-l.reverse().findIndex(e=>e===s[n-1]))/(n-1))}return a}async function aroon_down(e,t){for(var n=t||10,a=[],r=n;r<=e.length;r++){var l=e.slice(r-n,r),s=l.slice();s.sort((e,t)=>e-t),a.push(100*(n-1-l.reverse().findIndex(e=>e===s[0]))/(n-1))}return a}async function aroon_osc(e,t){for(var n=t||25,a=[],r=await aroon.up(e,n),l=await aroon.down(e,n),s=0;s<r.length;s++)a.push(r[s]-l[s]);return a}async function mfi(e,t){for(var n=t||14,a=[],r=e.map(e=>e[1]),l=e.map(e=>e[0]),s=n;s<=e.length;s++){var h=0,o=0;for(q=s-n;q<s;q++)h+=l[q],o+=r[q];a.push(100-100/(1+h/o))}return a}async function roc(e,t){for(var n=t||14,a=[],r=n;r<=e.length;r++)a.push((e[r-1]-e[r-n])/e[r-n]);return a}async function cop(e,t,n,a){t=t||11,n=n||14,a=a||10,max=Math.max(t,n),co=[];for(var r=max+a;r<e.length;r++){var l=e.slice(r-(max+a),r),s=l.slice(),h=[];l=await roc(l,t),s=await roc(s,n),l.splice(0,l.length-s.length),s.splice(0,s.length-l.length);for(var o=0;o<l.length;o++)h.push(l[o]+s[o]);h=await wma(h,a),co.push(h[h.length-1])}return co}async function kst(e,t,n,a,r,l,s,h,o,u){t=t||10,n=n||15,a=a||20,r=r||30,l=l||10,s=s||10,h=h||10,o=o||15,u=u||9;for(var i=[],p=[],c=Math.max(t,n,a,r)+Math.max(l,s,h,o),g=c;g<=e.length;g++){var m=e.slice(g-c,g),f=await roc(m,t),v=await roc(m,n),x=await roc(m,a),d=await roc(m,r);f=await sma(f,l),v=await sma(v,s),x=await sma(x,h),d=await sma(d,o),i.push(f[f.length-1]+v[v.length-1]+x[x.length-1]+d[d.length-1])}var w=await sma(i,u);for(var g in i.splice(0,i.length-w.length),w)p.push([i[g],w[g]]);return p}async function obv(e){for(var t=[0],n=1;n<e.length;n++)e[n][1]>e[n-1][1]&&t.push(t[t.length-1]+e[n][0]),e[n][1]<e[n-1][1]&&t.push(t[t.length-1]-e[n][0]),e[n][1]===e[n-1][1]&&t.push(t[t.length-1]);return t}async function vwap(e,t){for(var n=!t||t>e.length?e.length:t,a=(e=e.map(e=>[e[0]*e[1],e[1]]),[]),r=n;r<=e.length;r++){for(var l=e.slice(r-n,r),s=0,h=0,o=0;o<l.length;o++)s+=l[o][1],h+=l[o][0];a.push(h/s)}return a}async function mom(e,t,n){for(var a=t||10,r=[],l=a-1;l<e.length;l++)n?r.push(e[l]/e[l-(a-1)]*100):r.push(e[l]-e[l-(a-1)]);return r}async function mom_osc(e,t){for(var n=t?t+1:10,a=[],r=n;r<=e.length;r++){for(var l=0,s=0,h=1;h<n;h++)e[r-n+(h-1)]<e[r-n+h]?l+=e[r-n+h]:s+=e[r-n+h];a.push((l-s)/(l+s)*100)}return a}async function ha(e){for(var t=[[(Number(e[0][0])+Number(e[0][3]))/2,Number(e[0][1]),Number(e[0][2]),(Number(e[0][0])+Number(e[0][1])+Number(e[0][2])+Number(e[0][3]))/4]],n=1;n<e.length;n++)t.push([(t[t.length-1][0]+t[t.length-1][3])/2,Math.max(t[t.length-1][0],t[t.length-1][3],e[n][1]),Math.min(t[t.length-1][0],t[t.length-1][3],e[n][2]),(e[n][0]+e[n][1]+e[n][2]+e[n][3])/4]);return t}async function ren(e,t){for(var n=[],a=(t=t||1,Math.floor(t)===t?0:t.toString().split(".")[1].length||0),r=Math.ceil(e[0][0]/t*10**a)/10**a*t,l=r-t,s=1;s<e.length;s++){if(e[s][0]>r+t)do{n.push([r,r+t,r,r+t]),r+=t,l+=t}while(e[s][0]>r+t);if(e[s][1]<l-t)do{n.push([l,l,l-t,l-t]),r-=t,l-=t}while(e[s][1]<l-t)}return n}async function envelope(e,t,n){n=n||.005;for(var a=[],r=t=t||10;r<e.length;r++){var l=await sma(e.slice(r-t,r),t);a.push([l[0]*(1+n),l[0],l[0]*(1-n)])}return a}async function chaikin_osc(e,t,n){t=t||3,n=n||10;for(var a=[],r=[],l=0;l<e.length;l++){var s=(e[l][1]-e[l][2]-(e[l][0]-e[l][1]))/(e[l][0]-e[l][2]);isNaN(s)?r.push(0):r.push(s*e[l][3])}var h=await ema(r,t),o=await ema(r,n);h.length>o.length?h.splice(0,h.length-o.length):o.splice(0,o.length-h.length);for(l=0;l<h.length;l++)a.push(h[l]-o[l]);return a}async function fractals(e){for(var t=[[!1,!1],[!1,!1]],n=2;n<e.length-2;n++){var a=e[n-2][0]<e[n][0]&&e[n-1][0]<e[n][0]&&e[n][0]>e[n+1][0]&&e[n][0]>e[n+2][0],r=e[n-2][1]>e[n][1]&&e[n-1][1]>e[n][1]&&e[n][1]<e[n+1][1]&&e[n][1]<e[n+2][1];t.push([a,r])}return t.push([!1,!1],[!1,!1]),t}async function alligator(e,t,n,a,r,l,s){t=t||13,n=n||8,a=a||5,r=r||8,l=l||5,s=s||3;var h=[],o=await smma(e,t),u=await smma(e,n),i=await smma(e,a);u.splice(0,u.length-o.length),i.splice(0,i.length-o.length);for(var p=o.length-1;p>=7;p--)h.push([o[p-(r-1)],u[p-(l-1)],i[p-(s-1)]]);return h}async function gator(e,t,n,a,r,l,s){t=t||13,n=n||8,a=a||5,r=r||8,l=l||5,s=s||3;var h=[],o=await smma(e,t),u=await smma(e,n),i=await smma(e,a);u.splice(0,u.length-o.length),i.splice(0,i.length-o.length);for(var p=o.length-1;p>=r-1;p--)h.push([o[p-(r-1)]-u[p-(l-1)],-Math.abs(u[p-(l-1)]-i[p-(s-1)])]);return h}async function recent_high(e,t){for(var n=t=t||25,a=0,r=e[e.length-1],l=e.length-2;l>=0&&(e[l]>=r&&n>0?(r=e[l],a=l,n=t):n--,!(n<=0));l--);return{index:a,value:r}}async function recent_low(e,t){for(var n=t=t||25,a=0,r=e[e.length-1],l=e.length-2;l>=0&&(e[l]<=r&&n>0?(r=e[l],a=l,n=t):n--,!(n<=0));l--);return{index:a,value:r}}async function support(e,t){var n,a,r=(t=t||await recent_low(e)).value;do{for(var l=t.index;l<e.length;l++){var s=(t.value-e[l])/(t.index-l);s<r&&(r=s,n=l)}t.index+1==n&&n!=e.length-1?(t.index=n,r=Math.min.apply(null,e.slice()),t.value=e[t.index],a=!1):a=!0,t.index==e.length-1&&(a=!0)}while(!a);return n==e.length-1||t.index==e.length-1?{calculate:async e=>t.value,slope:0,lowest:t.value,index:t.index}:{calculate:async e=>e*r+t.value,slope:r,lowest:t.value,index:t.index}}async function resistance(e,t){var n,a,r=(t=t||await recent_high(e)).value;do{for(var l=t.index;l<e.length;l++){var s=(e[l]-t.value)/(t.index-l);s<r&&(r=s,n=l)}t.index+1==n&&n!=e.length-1?(t.index=n,r=Math.max.apply(null,e.slice()),t.value=e[t.index],a=!1):a=!0,t.index==e.length-1&&(a=!0)}while(!a);return n==e.length-1||t.index==e.length-1?{calculate:async e=>t.value,slope:0,highest:t.value,index:t.index}:{calculate:async e=>e*-r+t.value,slope:r,highest:t.value,index:t.index}}async function fisher(e,t){var n=[],a=0,r=0;for(let o=t;o<=e.length;o++){var l=e.slice(o-t,o),s=a,h=Math.min.apply(null,l);(r=.66*((e[o-1]-h)/(Math.max.apply(null,l)-h)-.5)+.67*r)>.99&&(r=.999),r<-.99&&(r=-.999),a=.5*Math.log((1+r)/(1-r))+.5*s,n.push([a,s])}return n.slice(1,n.length)}async function cross(e,t){e.splice(0,e.length-t.length);for(var n=e[0]>t[0],a=[],r=0;r<e.length;r++)e[r]<t[r]&&n&&(a.push({index:r,cross:!1}),n=!1),e[r]>t[r]&&!n&&(a.push({index:r,cross:!0}),n=!0);return a}async function se(e,t){return t=t||e.length,await std(e)/t**.5}async function halftrend(e,t,n,a){let r=[],l=[0],s=[0],h=[0],o=[0],u=void 0;for(let c=t;c<=e.length;c++){let g=e.slice(c-t,c);maxlow=g[g.length-2][2],minhigh=g[g.length-2][0],atr2=await atr(g,t),atr2=atr2[atr2.length-1]/2;let m=a*atr2,f=Math.max.apply(null,g.slice(g.length-1,g.length).map(e=>e[0])),v=Math.min.apply(null,g.slice(g.length-1,g.length).map(e=>e[2])),x=await sma(g.slice(g.length-n,g.length).map(e=>e[0]),n),d=await sma(g.slice(g.length-n,g.length).map(e=>e[2]),n);if(1==l[l.length-1]?(maxlow=Math.max(v,maxlow),x[0]<maxlow&&g[g.length-1][1]<g[g.length-2][2]&&(s.push(1),l.push(0),minhigh=g[g.length-2][0])):(minhigh=Math.min(f,minhigh),d[0]>minhigh&&g[g.length-1][1]<g[g.length-2][0]&&(s.push(0),l.push(1),maxlow=v)),0==s[s.length-1]){isNaN(s[s.length-2])||0==s[s.length-2]?h.push(isNaN(h[h.length-2])?maxlow:Math.max(h[h.length-2],maxlow)):h.push(isNaN(o[o.length-2])?o[o.length-1]:o[o.length-2]),u="long";var i=h[h.length-1]+m,p=h[h.length-1]-m}else{isNaN(s[s.length-2])||1==s[s.length-2]?o.push(isNaN(o[o.length-2])?minhigh:Math.min(minhigh,o[o.length-2])):o.push(isNaN(h[h.len-2])?h[h.length-1]:h[h.length-2]),u="short";i=o[o.length-1]+m,p=o[o.length-1]-m}r.push([i,0==s[s.length-1]?h[h.length-1]:o[o.length-1],p,u])}return r}const sum=async e=>e.reduce((e,t)=>e+t);async function covariance(e,t,n){let a=[];await sma(e,e.length),await sma(t,t.length);for(let r=n;r<=e.length;r++){let l=e.slice(r-n,r),s=t.slice(r-n,r),h=await sma(l,n),o=[],u=await sma(s,n);for(let e=0;e<n;e++)o.push((l[e]-h[0])*(s[e]-u[0]));o=await sum(o),a.push(o/n)}return a}const aroon={up:aroon_up,down:aroon_down,osc:aroon_osc}
