/* ta.js (c) Nino Kroesen. MIT License. */ async function median(t,n){for(var e=[],a=n||t.length;a<=t.length;a++){var r=t.slice(a-n,a);r.sort((t,n)=>t-n),e.push(r[Math.round(r.length/2)-1])}return e}async function kmeans(t,n){var e,a=[],r=[],l=[],h=!1,s=Math.round(t.length/(n+1));for(i=0;i<n;i++)r[i]=t[s*(i+1)];do{for(i=0;i<n;i++)a[i]=[];for(x=0;x<t.length;x++){var o=-1;for(y=0;y<n;y++){var u=Math.abs(r[y]-t[x]);-1===o?(o=u,e=y):u<=o&&(o=u,e=y)}a[e].push(t[x])}for(l=r,x=0;x<n;x++){var c=0;for(y=0;y<a[x].length;y++)c+=a[x][y];var p=c/a[e].length;r[x]=p}for(x=0;x<n;x++)r[x]!==l[x]&&(h=!0)}while(h);return a}async function normalize(t,n){n=n||0;for(var e=await Math.max.apply(null,t.slice())*(1+n),a=await Math.min.apply(null,t.slice())*(1-n),r=[],l=0;l<t.length;l++)r.push(1-(e-t[l])/(e-a));return r}async function denormalize(t,n,e){e=e||0;for(var a=await Math.max.apply(null,t.slice())*(1+e),r=await Math.min.apply(null,t.slice())*(1-e),l=[],h=0;h<n.length;h++)l.push(r+n[h]*(a-r));return l}async function normalize_pair(t,n){for(var e=(t[0]+n[0])/2,a=[[e,e]],r=1;r<t.length;r++)a.push([a[a.length-1][0]*((t[r]-t[r-1])/t[r-1]+1),a[a.length-1][1]*((n[r]-n[r-1])/n[r-1]+1)]);return a}async function normalize_from(t,n){for(var e=[n],a=1;a<t.length;a++)e.push(e[e.length-1]*((t[a]-t[a-1])/t[a-1]+1));return e}async function standardize(t){for(var n=await sma(t,t.length),e=await std(t),a=[],r=0;r<t.length;r++)a.push((t[r]-n[0])/e);return a}async function mad(t,n){for(var e=n||t.length,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=await median(l),s=l.map(t=>Math.abs(t-h[h.length-1]));s=await median(s),a.push(s[s.length-1])}return a}async function aad(t,n){for(var e=n||t.length,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=0,s=await sma(l,e);for(q in l)h+=Math.abs(l[q]-s[s.length-1]);a.push(h/e)}return a}async function ssd(t,n){for(var e=n||t.length,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=await sma(l,e),s=0;for(let t in l)s+=(l[t]-h[h.length-1])**2;a.push(Math.sqrt(s))}return a}async function er(t){var n=[],e=[],a=1,r=1;for(let a in t)t[a]>=0?n.push(1+t[a]):e.push(1+t[a]);var l=n.length/t.length,h=e.length/t.length;for(let t in e)r*=e[t];for(let t in n)a*=n[t];return(100*(a**(1/n.length)-1)*l+100*(r**(1/e.length)-1)*h)/100}async function ar(t,n){for(var e=[],a=n;a<t.length;a++){var r=await er(t.slice(a-n,a));e.push(t[a]-r)}return e}async function kelly(t){var n=await er(t)+1,e=await winratio(t);return e-(1-e)/n}async function winratio(t){var n=0,e=0;for(let a in t)t[a]>=0?n++:e++;return n/(e+n)}async function avgwin(t){for(var n=[],e=0;e<t.length;e++)t[e]>=0&&n.push(t[e]);return(await sma(n,n.length))[0]}async function avgloss(t){for(var n=[],e=0;e<t.length;e++)t[e]<0&&n.push(t[e]);return(await sma(n,n.length))[0]}async function zscore(t,n){var e=[],a=t.slice(0,n-1);for(let h=n-1;h<t.length;h++){a.push(t[h]);var r=await sma(a,n),l=await std(a,n);e.push((t[h]-r[0])/l),a.splice(0,1)}return e}async function rsi(t,n){for(var e=n||14,a=[],r=t.slice(0,e-1),l=e-1,h=0,s=0;l<t.length;l++,h=0,s=0){r.push(t[l]);for(var o=1;o<r.length;o++)r[o]-r[o-1]<0?s+=Math.abs(r[o]-r[o-1]):h+=r[o]-r[o-1];var u=100-100/(1+h/e/(s/e));a.push(u),r.splice(0,1)}return a}async function wrsi(t,n){for(var e=n||14,a=[],r=[],l=[],h=1;h<t.length;h++)t[h]-t[h-1]<0?(l.push(Math.abs(t[h]-t[h-1])),r.push(0)):(l.push(0),r.push(t[h]-t[h-1]));l=await wsma(l,e),r=await wsma(r,e);for(let t in l)a.push(100-100/(1+r[t]/l[t]));return a}async function tsi(t,n,e,a){for(var r=n||25,l=e||13,h=a||13,s=[],o=[],u=[],i=[],c=1;c<t.length;c++)s.push(t[c]-t[c-1]),o.push(Math.abs(t[c]-t[c-1]));var p=await ema(s,r),g=await ema(o,r),m=await ema(p,l),f=await ema(g,l);for(c=0;c<m.length;c++)u.push(m[c]/f[c]);var v=await ema(u,h);u.splice(0,u.length-v.length);for(c=0;c<v.length;c++)i.push([v[c],u[c]]);return i}async function bop(t,n){var e=t.map(t=>(t[3]-t[0])/(t[1]-t[2]));n=n||14;return e=await sma(e,n)}async function fi(t,n){for(var e=n||13,a=[],r=[],l=1;l<t.length;l++)if(a.push((t[l][0]-t[l-1][0])*t[l][1]),a.length>=e){var h=await ema(a,e);r.push(h[h.length-1]),a.splice(0,1)}return r}async function asi(t){for(var n=[],e=1;e<t.length;e++){var a,r=t[e][1],l=t[e-1][1],h=t[e][0],s=t[e-1][0],o=t[e][2],u=t[e-1][2],i=s-r>u-r?s-r:u-r,c=t[e][0],p=t[e-1][0],g=Math.max(t[e][0],t[e-1][0])-Math.min(t[e][2],t[e-1][2]);h-l>o-l&&h-l>h-o&&(a=h-l-(o-l)/2+(l-p)/4),o-l>h-l&&o-l>h-o&&(a=o-l-(h-l)/2+(l-p)/4),h-o>h-l&&h-o>o-l&&(a=h-o+(l-p)/4),n.push((l-r+(l-p)/2+(r-c)/2)/a*50*i/g)}return n}async function ao(t,n,e){var a=n||5,r=e||35,l=[];t=t.map(t=>(t[0]+t[1])/2);for(var h=r;h<=t.length;h++){var s=t.slice(h-r,h),o=await sma(s,a),u=await sma(s,r);l.push(o[o.length-1]-u[u.length-1])}return l}async function ac(t,n,e){n=n||5,e=e||35;var a=await ao(t,n,e),r=await sma(a,n),l=[];a.length>r.length?a.splice(0,a.length-r.length):r.splice(0,r.length-a.length);for(let t in a)l.push(a[t]-r[t]);return l}async function fib(t,n){return[t,.236*(n-t)+t,.382*(n-t)+t,.5*(n-t)+t,.618*(n-t)+t,.786*(n-t)+t,n,1.618*(n-t)+t,2.618*(n-t)+t,3.618*(n-t)+t,4.236*(n-t)+t]}async function pr(t,n){for(var e=n||14,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=await Math.max.apply(null,l),s=await Math.min.apply(null,l);a.push((h-t[r-1])/(h-s)*-100)}return a}async function lsma(t,n){for(var e=n||25,a=[],r=e;r<=t.length;r++){for(var l,h,s=t.slice(r-e,r),o=0,u=0,i=0,c=0,p=1;p<=e;p++)o+=p,u+=s[p-1],i+=s[p-1]*p,c+=p*p,s[p-1]*s[p-1];h=u/e-(l=(i-o*u/e)/(c-o*o/e))*o/e,a.push(l*e+h)}return a}async function don(t,n){for(var e=[],a=n||20,r=a;r<=t.length;r++){var l=t.slice(r-a,r),h=[],s=[];for(let t in l)h.push(l[t][0]),s.push(l[t][1]);var o=Math.max.apply(null,h.slice()),u=Math.min.apply(null,s.slice());e.push([o,(o+u)/2,u])}return e}async function ichimoku(t,n,e,a,r){for(var l=[],h=n||9,s=e||26,o=a||52,u=r||26,i=[],c=[],p=0;p<t.length;p++)if(l.push(t[p]),l.length>=o){var g=[],m=[];for(let t in l)g.push(l[t][0]),m.push(l[t][2]);var f=(Math.max.apply(null,g.slice(g.length-h,g.length))+Math.min.apply(null,m.slice(m.length-h,m.length)))/2,v=(Math.max.apply(null,g.slice(g.length-s,g.length))+Math.min.apply(null,m.slice(m.length-s,m.length)))/2,d=t[p][1]+v,x=(Math.max.apply(null,g.slice(g.length-o,g.length))+Math.min.apply(null,m.slice(m.length-s,m.length)))/2;chik=t[p][1],c.push([f,v,d,x,chik]),l.splice(0,1)}for(p=u;p<c.length-u;p++)i.push([c[p][0],c[p][1],c[p+u][2],c[p+u][3],c[p-u][4]]);return i}async function stoch(t,n,e,a){var r=n||14,l=e||3,h=a||3,s=[],o=[],u=[],i=[];r<l&&([r,l]=[l,r]),h>l&&([h,l]=[l,h]);for(var c=0;c<t.length;c++){if(o.push(t[c][0]),u.push(t[c][2]),o.length>=r){var p=await Math.max.apply(null,o),g=await Math.min.apply(null,u),m=100*(t[c][1]-g)/(p-g);i.push(m)}if(h>0&&i.length>h){var f=await sma(i,h);i.push(f[f.length-1])}if(i.length-h>=l){var v=await sma(i,l);s.push([m,v[v.length-1]]),o.splice(0,1),u.splice(0,1),i.splice(0,1)}}return s}async function atr(t,n){for(var e=n||14,a=[t[0][0]-t[0][2]],r=1;r<t.length;r++){var l=await Math.max(t[r][0]-t[r-1][1],t[r][2]-t[r-1][1],t[r][0]-t[r][2]);a.push((a[a.length-1]*(e-1)+l)/e)}return a}async function sma(t,n){for(var e=n||14,a=[],r=e;r<=t.length;r++){let n=await sum(t.slice(r-e,r));a.push(n/e)}return a}async function smma(t,n){for(var e=n||14,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=0;for(q in l)h+=l[q];a.length<=0?a.push(h/e):a.push((h-a[a.length-1])/e)}return a.splice(0,1),a}async function wma(t,n){for(var e=n||14,a=0,r=[],l=1;l<=e;l++)a+=l;for(l=e;l<=t.length;l++){var h=t.slice(l-e,l),s=0;for(q in h)s+=h[q]*(Number(q)+1)/a;r.push(s)}return r}async function wsma(t,n){for(var e=n||14,a=[],r=1/e,l=e;l<=t.length;l++)if(a.length>0)a.push((t[l-1]-a[a.length-1])*r+a[a.length-1]);else{var h=t.slice(l-e,l),s=0;for(q in h)s+=h[q];a.push(s/e)}return a}async function pwma(t,n){for(var e=0,a=[],r=[],l=n||14,h=l/2,s=n;h>=1;h--,s--)h%1!=0?e+=(h=Math.round(h))*s:(r.push(h*s),e+=h*s*2),r.unshift(h*s);for(h=l;h<=t.length;h++){for(var o=0,u=t.slice(h-l,h),i=l-1;i>=0;i--)o+=u[i]*r[i]/e;a.push(o)}return a}async function hwma(t,n){for(var e=0,a=[],r=[],l=n||14,h=1,s=l;h<=l/2;h++,s--)h%1!=0?e+=(h=Math.round(h))*s:(r.push(h*s),e+=h*s*2),r.unshift(h*s);for(h=l;h<=t.length;h++){for(var o=0,u=t.slice(h-l,h),i=l-1;i>=0;i--)o+=u[i]*r[i]/e;a.push(o)}return a}async function vwma(t,n){for(var e=n||20,a=[],r=(t=t.map(t=>[t[0]*t[1],t[1]]),e);r<=t.length;r++){for(var l=t.slice(r-e,r),h=0,s=0,o=0;o<l.length;o++)h+=l[o][1],s+=l[o][0];a.push(s/h)}return a}async function ema(t,n){for(var e=n||12,a=[],r=2/(e+1),l=e;l<=t.length;l++)if(a.length>0)a.push((t[l-1]-a[a.length-1])*r+a[a.length-1]);else{var h=t.slice(l-e,l),s=0;for(q in h)s+=h[q];a.push(s/e)}return a}async function hull(t,n){var e=n||14,a=[],r=[],l=await wma(t,e),h=Math.round(Math.sqrt(e)),s=await wma(t,Math.round(e/2));s.splice(0,s.length-l.length);for(let t in l)if(a.push(2*s[t]-l[t]),a.length>=h){var o=await wma(a,h);r.push(o[0]),a.splice(0,1)}return r}async function kama(t,n,e,a){n=n||10,e=e||2,a=a||30;for(var r=[(r=await sma(t,n))[r.length-1]],l=n+1;l<t.length;l++){for(var h=0,s=Math.abs(t[l]-t[l-n]),o=1;o<n;o++)h+=Math.abs(t[l-o]-t[l-o-1]);var u=(s/h*(2/(e+1)-2/(a+1)+2/(a+1)))**2;r.push(r[r.length-1]+u*(t[l]-r[r.length-1]))}return r}async function macd(t,n,e){var a=n||12,r=e||26;a>r&&([a,r]=[r,a]);var l=await ema(t,a),h=await ema(t,r),s=[];l.splice(0,r-a);for(var o=0;o<h.length;o++)s.push(l[o]-h[o]);return s}async function bands(t,n,e){for(var a=n||14,r=e||1,l=[],h=[],s=[],o=await sma(t,a),u=0;u<t.length;u++)if(l.push(t[u]),l.length>=a){var i=await std(l,a);h.push(i),l.splice(0,1)}for(u=0;u<o.length;u++)s.push([o[u]+h[u]*r,o[u],o[u]-h[u]*r]);return s}async function bandwidth(t,n,e){for(var a=n||14,r=e||1,l=[],h=await bands(t,a,r),s=0;s<h.length;s++)l.push((h[s][0]-h[s][2])/h[s][1]);return l}async function keltner(t,n,e){var a,r=n||14,l=e||1,h=[],s=await atr(t,r),o=[];for(var u in t)h.push((t[u][0]+t[u][1]+t[u][2])/3);a=await sma(h,r),s.splice(0,r-1);for(u=0;u<a.length;u++)o.push([a[u]+s[u]*l,a[u],a[u]-s[u]*l]);return o}async function variance(t,n){for(var e=n||t.length,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=await sma(l,e),s=0;for(x in l)s+=(l[x]-h[h.length-1])**2;a.push(s/e)}return a}async function std(t,n){var e=n||t.length,a=t.reduce((t,n)=>Number(t)+Number(n))/e;return Math.sqrt(t.reduce((t,n)=>t+Math.pow(n-a,2),0)/e)}async function normsinv(t){var n=-.00778489400243029,e=-.322396458041136,a=-2.40075827716184,r=-2.54973253934373,l=4.37466414146497,h=2.93816398269878,s=.00778469570904146,o=.32246712907004,u=2.445134137143,i=3.75440866190742;if(t<0||t>1)return 0;if(t<.02425)return(((((n*(c=Math.sqrt(-2*Math.log(t)))+e)*c+a)*c+r)*c+l)*c+h)/((((s*c+o)*c+u)*c+i)*c+1);if(t<=.97575){var c,p=(c=t-.5)*c;return(((((-39.6968302866538*p+220.946098424521)*p-275.928510446969)*p+138.357751867269)*p-30.6647980661472)*p+2.50662827745924)*c/(((((-54.4760987982241*p+161.585836858041)*p-155.698979859887)*p+66.8013118877197)*p-13.2806815528857)*p+1)}return-(((((n*(c=Math.sqrt(-2*Math.log(1-t)))+e)*c+a)*c+r)*c+l)*c+h)/((((s*c+o)*c+u)*c+i)*c+1)}async function sim(t,n,e,a){for(var r=[],l=(n=n||50,e=e||1e3,0);l<e;l++){for(var h=t.slice(),s=0;s<n;s++){for(var o=[],u=1;u<h.length;u++){var i=await dif(h[u],h[u-1]);o.push(i)}var c=await sma(o,o.length),p=await std(o),g=await normsinv(Math.random());h.push(h[h.length-1]*Math.exp(c[0]-p*p/2+p*g))}r.push(h)}return a?await percentile(r,a):r}async function percentile(t,n){for(var e=[],a=0;a<t[0].length;a++)t.sort((t,n)=>t[a]-n[a]),e.push(t[Math.round((t.length-1)*n)][a]);return e}async function cor(t,n){for(var e=await sma(t,t.length),a=await sma(n,n.length),r=0,l=0,h=0,s=0;s<t.length;s++){var o=t[s]-e,u=n[s]-a;r+=o*u,l+=Math.pow(o,2),h+=Math.pow(u,2)}var i=t.length-1;return l/=i,h/=i,r/(i*(l=Math.sqrt(l))*(h=Math.sqrt(h)))}async function dif(t,n){return(t-n)/n}async function log(t){return t.map(t=>Math.log(t))}async function exp(t){return t.map(t=>Math.exp(t))}async function drawdown(t){for(var n=t[0],e=t[0],a=0,r=1;r<t.length;r++){if(t[r]>n){if(0!=e)(l=await dif(e,n))<a&&(a=l),e=t[r];n=t[r]}t[r]<e&&(e=t[r])}var l;return(l=await dif(e,n))<a&&(a=l),a}async function aroon_up(t,n){for(var e=n||10,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=l.slice();h.sort((t,n)=>t-n),a.push(100*(e-1-l.reverse().findIndex(t=>t===h[e-1]))/(e-1))}return a}async function aroon_down(t,n){for(var e=n||10,a=[],r=e;r<=t.length;r++){var l=t.slice(r-e,r),h=l.slice();h.sort((t,n)=>t-n),a.push(100*(e-1-l.reverse().findIndex(t=>t===h[0]))/(e-1))}return a}async function aroon_osc(t,n){for(var e=n||25,a=[],r=await aroon.up(t,e),l=await aroon.down(t,e),h=0;h<r.length;h++)a.push(r[h]-l[h]);return a}async function mfi(t,n){for(var e=n||14,a=[],r=t.map(t=>t[1]),l=t.map(t=>t[0]),h=e;h<=t.length;h++){var s=0,o=0;for(q=h-e;q<h;q++)s+=l[q],o+=r[q];a.push(100-100/(1+s/o))}return a}async function roc(t,n){for(var e=n||14,a=[],r=e;r<=t.length;r++)a.push((t[r-1]-t[r-e])/t[r-e]);return a}async function cop(t,n,e,a){n=n||11,e=e||14,a=a||10,max=Math.max(n,e),co=[];for(var r=max+a;r<t.length;r++){var l=t.slice(r-(max+a),r),h=l.slice(),s=[];l=await roc(l,n),h=await roc(h,e),l.splice(0,l.length-h.length),h.splice(0,h.length-l.length);for(var o=0;o<l.length;o++)s.push(l[o]+h[o]);s=await wma(s,a),co.push(s[s.length-1])}return co}async function kst(t,n,e,a,r,l,h,s,o,u){n=n||10,e=e||15,a=a||20,r=r||30,l=l||10,h=h||10,s=s||10,o=o||15,u=u||9;for(var i=[],c=[],p=Math.max(n,e,a,r)+Math.max(l,h,s,o),g=p;g<=t.length;g++){var m=t.slice(g-p,g),f=await roc(m,n),v=await roc(m,e),d=await roc(m,a),x=await roc(m,r);f=await sma(f,l),v=await sma(v,h),d=await sma(d,s),x=await sma(x,o),i.push(f[f.length-1]+v[v.length-1]+d[d.length-1]+x[x.length-1])}var w=await sma(i,u);for(var g in i.splice(0,i.length-w.length),w)c.push([i[g],w[g]]);return c}async function obv(t){for(var n=[0],e=1;e<t.length;e++)t[e][1]>t[e-1][1]&&n.push(n[n.length-1]+t[e][0]),t[e][1]<t[e-1][1]&&n.push(n[n.length-1]-t[e][0]),t[e][1]===t[e-1][1]&&n.push(n[n.length-1]);return n}async function vwap(t,n){for(var e=!n||n>t.length?t.length:n,a=(t=t.map(t=>[t[0]*t[1],t[1]]),[]),r=e;r<=t.length;r++){for(var l=t.slice(r-e,r),h=0,s=0,o=0;o<l.length;o++)h+=l[o][1],s+=l[o][0];a.push(s/h)}return a}async function mom(t,n,e){for(var a=n||10,r=[],l=a-1;l<t.length;l++)e?r.push(t[l]/t[l-(a-1)]*100):r.push(t[l]-t[l-(a-1)]);return r}async function mom_osc(t,n){for(var e=n?n+1:10,a=[],r=e;r<=t.length;r++){for(var l=0,h=0,s=1;s<e;s++)t[r-e+(s-1)]<t[r-e+s]?l+=t[r-e+s]:h+=t[r-e+s];a.push((l-h)/(l+h)*100)}return a}async function ha(t){for(var n=[[(Number(t[0][0])+Number(t[0][3]))/2,Number(t[0][1]),Number(t[0][2]),(Number(t[0][0])+Number(t[0][1])+Number(t[0][2])+Number(t[0][3]))/4]],e=1;e<t.length;e++)n.push([(n[n.length-1][0]+n[n.length-1][3])/2,Math.max(n[n.length-1][0],n[n.length-1][3],t[e][1]),Math.min(n[n.length-1][0],n[n.length-1][3],t[e][2]),(t[e][0]+t[e][1]+t[e][2]+t[e][3])/4]);return n}async function ren(t,n){for(var e=[],a=(n=n||1,Math.floor(n)===n?0:n.toString().split(".")[1].length||0),r=Math.ceil(t[0][0]/n*10**a)/10**a*n,l=r-n,h=1;h<t.length;h++){if(t[h][0]>r+n)do{e.push([r,r+n,r,r+n]),r+=n,l+=n}while(t[h][0]>r+n);if(t[h][1]<l-n)do{e.push([l,l,l-n,l-n]),r-=n,l-=n}while(t[h][1]<l-n)}return e}async function envelope(t,n,e){e=e||.005;for(var a=[],r=n=n||10;r<t.length;r++){var l=await sma(t.slice(r-n,r),n);a.push([l[0]*(1+e),l[0],l[0]*(1-e)])}return a}async function chaikin_osc(t,n,e){n=n||3,e=e||10;for(var a=[],r=[],l=0;l<t.length;l++){var h=(t[l][1]-t[l][2]-(t[l][0]-t[l][1]))/(t[l][0]-t[l][2]);isNaN(h)?r.push(0):r.push(h*t[l][3])}var s=await ema(r,n),o=await ema(r,e);s.length>o.length?s.splice(0,s.length-o.length):o.splice(0,o.length-s.length);for(l=0;l<s.length;l++)a.push(s[l]-o[l]);return a}async function fractals(t){for(var n=[[!1,!1],[!1,!1]],e=2;e<t.length-2;e++){var a=t[e-2][0]<t[e][0]&&t[e-1][0]<t[e][0]&&t[e][0]>t[e+1][0]&&t[e][0]>t[e+2][0],r=t[e-2][1]>t[e][1]&&t[e-1][1]>t[e][1]&&t[e][1]<t[e+1][1]&&t[e][1]<t[e+2][1];n.push([a,r])}return n.push([!1,!1],[!1,!1]),n}async function alligator(t,n,e,a,r,l,h){n=n||13,e=e||8,a=a||5,r=r||8,l=l||5,h=h||3;var s=[],o=await smma(t,n),u=await smma(t,e),i=await smma(t,a);u.splice(0,u.length-o.length),i.splice(0,i.length-o.length);for(var c=o.length-1;c>=7;c--)s.push([o[c-(r-1)],u[c-(l-1)],i[c-(h-1)]]);return s}async function gator(t,n,e,a,r,l,h){n=n||13,e=e||8,a=a||5,r=r||8,l=l||5,h=h||3;var s=[],o=await smma(t,n),u=await smma(t,e),i=await smma(t,a);u.splice(0,u.length-o.length),i.splice(0,i.length-o.length);for(var c=o.length-1;c>=r-1;c--)s.push([o[c-(r-1)]-u[c-(l-1)],-Math.abs(u[c-(l-1)]-i[c-(h-1)])]);return s}async function recent_high(t,n){for(var e=n=n||25,a=0,r=t[t.length-1],l=t.length-2;l>=0&&(t[l]>=r&&e>0?(r=t[l],a=l,e=n):e--,!(e<=0));l--);return{index:a,value:r}}async function recent_low(t,n){for(var e=n=n||25,a=0,r=t[t.length-1],l=t.length-2;l>=0&&(t[l]<=r&&e>0?(r=t[l],a=l,e=n):e--,!(e<=0));l--);return{index:a,value:r}}async function support(t,n){var e,a,r=(n=n||await recent_low(t)).value;do{for(var l=n.index;l<t.length;l++){var h=(n.value-t[l])/(n.index-l);h<r&&(r=h,e=l)}n.index+1==e&&e!=t.length-1?(n.index=e,r=Math.min.apply(null,t.slice()),n.value=t[n.index],a=!1):a=!0,n.index==t.length-1&&(a=!0)}while(!a);return e==t.length-1||n.index==t.length-1?{calculate:async t=>n.value,slope:0,lowest:n.value,index:n.index}:{calculate:async t=>t*r+n.value,slope:r,lowest:n.value,index:n.index}}async function resistance(t,n){var e,a,r=(n=n||await recent_high(t)).value;do{for(var l=n.index;l<t.length;l++){var h=(t[l]-n.value)/(n.index-l);h<r&&(r=h,e=l)}n.index+1==e&&e!=t.length-1?(n.index=e,r=Math.max.apply(null,t.slice()),n.value=t[n.index],a=!1):a=!0,n.index==t.length-1&&(a=!0)}while(!a);return e==t.length-1||n.index==t.length-1?{calculate:async t=>n.value,slope:0,highest:n.value,index:n.index}:{calculate:async t=>t*-r+n.value,slope:r,highest:n.value,index:n.index}}async function fisher(t,n){var e=[],a=0,r=0;for(let o=n;o<=t.length;o++){var l=t.slice(o-n,o),h=a,s=Math.min.apply(null,l);(r=.66*((t[o-1]-s)/(Math.max.apply(null,l)-s)-.5)+.67*r)>.99&&(r=.999),r<-.99&&(r=-.999),a=.5*Math.log((1+r)/(1-r))+.5*h,e.push([a,h])}return e.slice(1,e.length)}async function cross(t,n){t.splice(0,t.length-n.length);for(var e=t[0]>n[0],a=[],r=0;r<t.length;r++)t[r]<n[r]&&e&&(a.push({index:r,cross:!1}),e=!1),t[r]>n[r]&&!e&&(a.push({index:r,cross:!0}),e=!0);return a}async function se(t,n){return n=n||t.length,await std(t)/n**.5}async function halftrend(t,n,e,a){let r=[],l=[0],h=[0],s=[0],o=[0],u=void 0;for(let p=n;p<=t.length;p++){let g=t.slice(p-n,p);maxlow=g[g.length-2][2],minhigh=g[g.length-2][0],atr2=await atr(g,n),atr2=atr2[atr2.length-1]/2;let m=a*atr2,f=Math.max.apply(null,g.slice(g.length-1,g.length).map(t=>t[0])),v=Math.min.apply(null,g.slice(g.length-1,g.length).map(t=>t[2])),d=await sma(g.slice(g.length-e,g.length).map(t=>t[0]),e),x=await sma(g.slice(g.length-e,g.length).map(t=>t[2]),e);if(1==l[l.length-1]?(maxlow=Math.max(v,maxlow),d[0]<maxlow&&g[g.length-1][1]<g[g.length-2][2]&&(h.push(1),l.push(0),minhigh=g[g.length-2][0])):(minhigh=Math.min(f,minhigh),x[0]>minhigh&&g[g.length-1][1]<g[g.length-2][0]&&(h.push(0),l.push(1),maxlow=v)),0==h[h.length-1]){isNaN(h[h.length-2])||0==h[h.length-2]?s.push(isNaN(s[s.length-2])?maxlow:Math.max(s[s.length-2],maxlow)):s.push(isNaN(o[o.length-2])?o[o.length-1]:o[o.length-2]),u="long";var i=s[s.length-1]+m,c=s[s.length-1]-m}else{isNaN(h[h.length-2])||1==h[h.length-2]?o.push(isNaN(o[o.length-2])?minhigh:Math.min(minhigh,o[o.length-2])):o.push(isNaN(s[s.len-2])?s[s.length-1]:s[s.length-2]),u="short";i=o[o.length-1]+m,c=o[o.length-1]-m}r.push([i,0==h[h.length-1]?s[s.length-1]:o[o.length-1],c,u])}return r}const sum=async t=>t.reduce((t,n)=>t+n);async function covariance(t,n,e){let a=[];await sma(t,t.length),await sma(n,n.length);for(let r=e;r<=t.length;r++){let l=t.slice(r-e,r),h=n.slice(r-e,r),s=await sma(l,e),o=[],u=await sma(h,e);for(let t=0;t<e;t++)o.push((l[t]-s[0])*(h[t]-u[0]));o=await sum(o),a.push(o/e)}return a}const range=(t,n,e)=>Math.floor(e?e()*(Math.floor(n)-Math.ceil(t))+Math.ceil(t):Math.random()*(Math.floor(n)-Math.ceil(t))+Math.ceil(t)),pick=(t,n)=>t[Math.floor(n?n()*Math.floor(t.length):Math.random()*Math.floor(t.length))],float=(t,n,e)=>e?e()*(n-t)+t:Math.random()*(n-t)+t;function prng(t){for(var n=0,e=1779033703^t.length;n<t.length;n++)e=(e=Math.imul(e^t.charCodeAt(n),3432918353))<<13|e>>>19;return e=Math.imul(e^e>>>16,2246822507),e=Math.imul(e^e>>>13,3266489909),t=(e^=e>>>16)>>>0,function(){var n=t+=1831565813;return n=Math.imul(n^n>>>15,1|n),(((n^=n+Math.imul(n^n>>>7,61|n))^n>>>14)>>>0)/4294967296}}async function ncdf(t,n,e){t=n||e?(t-n)/e:t;var a=1/(1+.2315419*Math.abs(t)),r=.3989423*Math.exp(-t*t/2)*a*(.3193815+a*(a*(1.781478+a*(1.330274*a-1.821256))-.3565638));return t>0?1-r:r}const random={range,pick,float,prng};const aroon={up:aroon_up,down:aroon_down,osc:aroon_osc};
